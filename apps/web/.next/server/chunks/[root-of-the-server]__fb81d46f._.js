module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},89139,36843,e=>{"use strict";var t=e.i(63206);e.s([],89139),e.s(["logger",()=>t.i],36843)},35722,e=>e.a(async(t,r)=>{try{var n=e.i(53707),a=t([n]);async function o(e){return n.auth.api.getSession({headers:e.headers})}[n]=a.then?(await a)():a,e.s(["getSession",()=>o]),r()}catch(e){r(e)}},!1),20635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},8595,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return a}});class n extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class a extends URLSearchParams{append(){throw new n}delete(){throw new n}set(){throw new n}sort(){throw new n}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},50723,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RedirectStatusCode",{enumerable:!0,get:function(){return a}});var n,a=((n={})[n.SeeOther=303]="SeeOther",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},19334,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,a={REDIRECT_ERROR_CODE:function(){return u},RedirectType:function(){return s},isRedirectError:function(){return l}};for(var o in a)Object.defineProperty(r,o,{enumerable:!0,get:a[o]});let i=e.r(50723),u="NEXT_REDIRECT";var s=((n={}).push="push",n.replace="replace",n);function l(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let t=e.digest.split(";"),[r,n]=t,a=t.slice(2,-2).join(";"),o=Number(t.at(-2));return r===u&&("replace"===n||"push"===n)&&"string"==typeof a&&!isNaN(o)&&o in i.RedirectStatusCode}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},22349,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={getRedirectError:function(){return s},getRedirectStatusCodeFromError:function(){return f},getRedirectTypeFromError:function(){return p},getURLFromRedirectError:function(){return c},permanentRedirect:function(){return d},redirect:function(){return l}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let o=e.r(50723),i=e.r(19334),u=e.r(20635).actionAsyncStorage;function s(e,t,r=o.RedirectStatusCode.TemporaryRedirect){let n=Object.defineProperty(Error(i.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n.digest=`${i.REDIRECT_ERROR_CODE};${t};${e};${r};`,n}function l(e,t){throw s(e,t??=u?.getStore()?.isAction?i.RedirectType.push:i.RedirectType.replace,o.RedirectStatusCode.TemporaryRedirect)}function d(e,t=i.RedirectType.replace){throw s(e,t,o.RedirectStatusCode.PermanentRedirect)}function c(e){return(0,i.isRedirectError)(e)?e.digest.split(";").slice(2,-2).join(";"):null}function p(e){if(!(0,i.isRedirectError)(e))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return e.digest.split(";",2)[1]}function f(e){if(!(0,i.isRedirectError)(e))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(e.digest.split(";").at(-2))}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},12053,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={HTTPAccessErrorStatus:function(){return o},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return u},getAccessFallbackErrorTypeByStatus:function(){return d},getAccessFallbackHTTPStatus:function(){return l},isHTTPAccessFallbackError:function(){return s}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let o={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},i=new Set(Object.values(o)),u="NEXT_HTTP_ERROR_FALLBACK";function s(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let[t,r]=e.digest.split(";");return t===u&&i.has(Number(r))}function l(e){return Number(e.digest.split(";")[1])}function d(e){switch(e){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},2507,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"notFound",{enumerable:!0,get:function(){return o}});let n=e.r(12053),a=`${n.HTTP_ERROR_FALLBACK_ERROR_CODE};404`;function o(){let e=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw e.digest=a,e}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},47658,(e,t,r)=>{"use strict";function n(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"forbidden",{enumerable:!0,get:function(){return n}}),e.r(12053).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},72109,(e,t,r)=>{"use strict";function n(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unauthorized",{enumerable:!0,get:function(){return n}}),e.r(12053).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},67539,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isPostpone",{enumerable:!0,get:function(){return a}});let n=Symbol.for("react.postpone");function a(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}},62782,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isNextRouterError",{enumerable:!0,get:function(){return o}});let n=e.r(12053),a=e.r(19334);function o(e){return(0,a.isRedirectError)(e)||(0,n.isHTTPAccessFallbackError)(e)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},17387,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unstable_rethrow",{enumerable:!0,get:function(){return function e(t){if((0,i.isNextRouterError)(t)||(0,o.isBailoutToCSRError)(t)||(0,s.isDynamicServerError)(t)||(0,u.isDynamicPostpone)(t)||(0,a.isPostpone)(t)||(0,n.isHangingPromiseRejectionError)(t)||(0,u.isPrerenderInterruptedError)(t))throw t;t instanceof Error&&"cause"in t&&e(t.cause)}}});let n=e.r(4642),a=e.r(67539),o=e.r(31584),i=e.r(62782),u=e.r(68665),s=e.r(65252);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},9811,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"unstable_rethrow",{enumerable:!0,get:function(){return n}});let n=e.r(17387).unstable_rethrow;("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},79509,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ReadonlyURLSearchParams:function(){return o.ReadonlyURLSearchParams},RedirectType:function(){return u.RedirectType},forbidden:function(){return l.forbidden},notFound:function(){return s.notFound},permanentRedirect:function(){return i.permanentRedirect},redirect:function(){return i.redirect},unauthorized:function(){return d.unauthorized},unstable_isUnrecognizedActionError:function(){return p},unstable_rethrow:function(){return c.unstable_rethrow}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let o=e.r(8595),i=e.r(22349),u=e.r(19334),s=e.r(2507),l=e.r(47658),d=e.r(72109),c=e.r(9811);function p(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},51783,e=>{"use strict";e.i(79509),e.s([])},19018,e=>e.a(async(t,r)=>{try{e.i(51783);var n=e.i(79509),a=e.i(3985),o=e.i(35722),i=t([a,o]);[a,o]=i.then?(await i)():i;let s=process.env.POLAR_ACCESS_TOKEN,l=process.env.SITE_URL||"http://localhost:3000";async function u(e){let t=new URL(e.url).searchParams.get("orgId");if(!t)return Response.json({error:"orgId required"},{status:400});let r=await (0,o.getSession)(e);r||(0,n.redirect)(`${l}/login`);let i=await a.db.selectFrom("organizations").innerJoin("org_members","org_members.orgId","organizations.id").where("organizations.id","=",t).where("org_members.userId","=",r.user.id).where("org_members.role","in",["owner","admin"]).select(["organizations.polarCustomerId"]).executeTakeFirst();if(!i?.polarCustomerId)return Response.json({error:"No billing account found"},{status:404});let u=await fetch("https://api.polar.sh/v1/customer-portal/sessions",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({customer_id:i.polarCustomerId})});if(!u.ok){let e=await u.text();return console.error("Polar portal error:",e),Response.json({error:"Failed to create portal session"},{status:500})}let d=await u.json();(0,n.redirect)(d.url)}e.s(["GET",()=>u]),r()}catch(e){r(e)}},!1),75629,e=>e.a(async(t,r)=>{try{var n=e.i(47909),a=e.i(74017),o=e.i(96250),i=e.i(59756),u=e.i(61916),s=e.i(14444),l=e.i(37092),d=e.i(69741),c=e.i(16795),p=e.i(87718),f=e.i(95169),_=e.i(47587),b=e.i(66012),R=e.i(70101),y=e.i(26937),h=e.i(10372),E=e.i(93695);e.i(52474);var g=e.i(220),v=e.i(19018),m=t([v]);[v]=m.then?(await m)():m;let P=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/billing/portal/route",pathname:"/api/billing/portal",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/billing/portal/route.ts",nextConfigOutput:"",userland:v}),{workAsyncStorage:x,workUnitAsyncStorage:w,serverHooks:T}=P;function O(){return(0,o.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:w})}async function j(e,t,r){P.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/billing/portal/route";n=n.replace(/\/index$/,"")||"/";let o=await P.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:m,nextConfig:O,parsedUrl:j,isDraftMode:x,prerenderManifest:w,routerServerContext:T,isOnDemandRevalidate:C,revalidateOnlyGenerated:M,resolvedPathname:A,clientReferenceManifest:S,serverActionsManifest:N}=o,D=(0,d.normalizeAppPath)(n),k=!!(w.dynamicRoutes[D]||w.routes[A]),I=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,j,!1):t.end("This page could not be found"),null);if(k&&!x){let e=!!w.routes[A],t=w.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(O.experimental.adapterPath)return await I();throw new E.NoFallbackError}}let U=null;!k||P.isDev||x||(U=A,U="/index"===U?"/":U);let F=!0===P.isDev||!k,H=k&&!F;N&&S&&(0,s.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:S,serverActionsManifest:N,serverModuleMap:(0,l.createServerModuleMap)({serverActionsManifest:N})});let L=e.method||"GET",q=(0,u.getTracer)(),$=q.getActiveScopeSpan(),B={params:m,prerenderManifest:w,renderOpts:{experimental:{authInterrupts:!!O.experimental.authInterrupts},cacheComponents:!!O.cacheComponents,supportsDynamicResponse:F,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:O.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>P.onRequestError(e,t,n,T)},sharedContext:{buildId:v}},K=new c.NodeNextRequest(e),z=new c.NodeNextResponse(t),X=p.NextRequestAdapter.fromNodeNextRequest(K,(0,p.signalFromNodeResponse)(t));try{let o=async e=>P.handle(X,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=q.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==f.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${L} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${n}`)}),s=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var u,l;let d=async({previousCacheEntry:a})=>{try{if(!s&&C&&M&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let u=B.renderOpts.pendingWaitUntil;u&&r.waitUntil&&(r.waitUntil(u),u=void 0);let l=B.renderOpts.collectedTags;if(!k)return await (0,b.sendResponse)(K,z,n,B.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,R.toNodeOutgoingHttpHeaders)(n.headers);l&&(t[h.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,a=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await P.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,_.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:C})},T),t}},c=await P.handleResponse({req:e,nextConfig:O,cacheKey:U,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:w,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:M,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:s});if(!k)return null;if((null==c||null==(u=c.value)?void 0:u.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",C?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),x&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,R.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&k||p.delete(h.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,y.getCacheControlHeader)(c.cacheControl)),await (0,b.sendResponse)(K,z,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};$?await l($):await q.withPropagatedContext(e.headers,()=>q.trace(f.BaseServerSpan.handleRequest,{spanName:`${L} ${n}`,kind:u.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},l))}catch(t){if(t instanceof E.NoFallbackError||await P.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,_.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:C})}),k)throw t;return await (0,b.sendResponse)(K,z,new Response(null,{status:500})),null}}e.s(["handler",()=>j,"patchFetch",()=>O,"routeModule",()=>P,"serverHooks",()=>T,"workAsyncStorage",()=>x,"workUnitAsyncStorage",()=>w]),r()}catch(e){r(e)}},!1),76372,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_better-auth_dist_adapters_memory-adapter_index_mjs_61d56fbe._.js"].map(t=>e.l(t))).then(()=>t(68840)))},46120,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_better-auth_dist_adapters_kysely-adapter_index_mjs_e4618ae6._.js"].map(t=>e.l(t))).then(()=>t(69580)))},96605,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_better-auth_dist_adapters_kysely-adapter_bun-sqlite-dialect_mjs_81919b3b._.js"].map(t=>e.l(t))).then(()=>t(58634)))},61487,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_better-auth_dist_adapters_kysely-adapter_node-sqlite-dialect_mjs_4d47c97e._.js"].map(t=>e.l(t))).then(()=>t(2770)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__fb81d46f._.js.map