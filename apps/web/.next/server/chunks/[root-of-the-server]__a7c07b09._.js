module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},42548,e=>{"use strict";let t={free:{aiCallsPerMonth:0,privateRepos:0,analysesPerDay:100,members:1,historyDays:0},team:{aiCallsPerMonth:5e3,privateRepos:1/0,analysesPerDay:1e3,members:1/0,historyDays:30},pro:{aiCallsPerMonth:25e3,privateRepos:1/0,analysesPerDay:1e4,members:1/0,historyDays:90},enterprise:{aiCallsPerMonth:1/0,privateRepos:1/0,analysesPerDay:1/0,members:1/0,historyDays:365},hero:{aiCallsPerMonth:25e3,privateRepos:1/0,analysesPerDay:1e4,members:1/0,historyDays:90}};function r(e){return t[e]??t.free}e.s(["getPlanLimits",()=>r])},33811,e=>{"use strict";e.i(42548),e.s([],33811)},22632,e=>{"use strict";e.s([],54033),e.i(54033);var t=e.i(85676),r=e.i(80264);e.s(["defaultErrorMap",()=>r.default,"getErrorMap",()=>t.getErrorMap,"setErrorMap",()=>t.setErrorMap],76733),e.i(76733);var a=e.i(84488);e.s([],91316),e.i(91316);var n=e.i(42944),o=e.i(17958),i=e.i(15235);e.s(["BRAND",()=>o.BRAND,"DIRTY",()=>a.DIRTY,"EMPTY_PATH",()=>a.EMPTY_PATH,"INVALID",()=>a.INVALID,"NEVER",()=>o.NEVER,"OK",()=>a.OK,"ParseStatus",()=>a.ParseStatus,"Schema",()=>o.Schema,"ZodAny",()=>o.ZodAny,"ZodArray",()=>o.ZodArray,"ZodBigInt",()=>o.ZodBigInt,"ZodBoolean",()=>o.ZodBoolean,"ZodBranded",()=>o.ZodBranded,"ZodCatch",()=>o.ZodCatch,"ZodDate",()=>o.ZodDate,"ZodDefault",()=>o.ZodDefault,"ZodDiscriminatedUnion",()=>o.ZodDiscriminatedUnion,"ZodEffects",()=>o.ZodEffects,"ZodEnum",()=>o.ZodEnum,"ZodError",()=>i.ZodError,"ZodFirstPartyTypeKind",()=>o.ZodFirstPartyTypeKind,"ZodFunction",()=>o.ZodFunction,"ZodIntersection",()=>o.ZodIntersection,"ZodIssueCode",()=>i.ZodIssueCode,"ZodLazy",()=>o.ZodLazy,"ZodLiteral",()=>o.ZodLiteral,"ZodMap",()=>o.ZodMap,"ZodNaN",()=>o.ZodNaN,"ZodNativeEnum",()=>o.ZodNativeEnum,"ZodNever",()=>o.ZodNever,"ZodNull",()=>o.ZodNull,"ZodNullable",()=>o.ZodNullable,"ZodNumber",()=>o.ZodNumber,"ZodObject",()=>o.ZodObject,"ZodOptional",()=>o.ZodOptional,"ZodParsedType",()=>n.ZodParsedType,"ZodPipeline",()=>o.ZodPipeline,"ZodPromise",()=>o.ZodPromise,"ZodReadonly",()=>o.ZodReadonly,"ZodRecord",()=>o.ZodRecord,"ZodSchema",()=>o.ZodSchema,"ZodSet",()=>o.ZodSet,"ZodString",()=>o.ZodString,"ZodSymbol",()=>o.ZodSymbol,"ZodTransformer",()=>o.ZodTransformer,"ZodTuple",()=>o.ZodTuple,"ZodType",()=>o.ZodType,"ZodUndefined",()=>o.ZodUndefined,"ZodUnion",()=>o.ZodUnion,"ZodUnknown",()=>o.ZodUnknown,"ZodVoid",()=>o.ZodVoid,"addIssueToContext",()=>a.addIssueToContext,"any",()=>o.any,"array",()=>o.array,"bigint",()=>o.bigint,"boolean",()=>o.boolean,"coerce",()=>o.coerce,"custom",()=>o.custom,"date",()=>o.date,"datetimeRegex",()=>o.datetimeRegex,"defaultErrorMap",()=>r.default,"discriminatedUnion",()=>o.discriminatedUnion,"effect",()=>o.effect,"enum",()=>o.enum,"function",()=>o.function,"getErrorMap",()=>t.getErrorMap,"getParsedType",()=>n.getParsedType,"instanceof",()=>o.instanceof,"intersection",()=>o.intersection,"isAborted",()=>a.isAborted,"isAsync",()=>a.isAsync,"isDirty",()=>a.isDirty,"isValid",()=>a.isValid,"late",()=>o.late,"lazy",()=>o.lazy,"literal",()=>o.literal,"makeIssue",()=>a.makeIssue,"map",()=>o.map,"nan",()=>o.nan,"nativeEnum",()=>o.nativeEnum,"never",()=>o.never,"null",()=>o.null,"nullable",()=>o.nullable,"number",()=>o.number,"object",()=>o.object,"objectUtil",()=>n.objectUtil,"oboolean",()=>o.oboolean,"onumber",()=>o.onumber,"optional",()=>o.optional,"ostring",()=>o.ostring,"pipeline",()=>o.pipeline,"preprocess",()=>o.preprocess,"promise",()=>o.promise,"quotelessJson",()=>i.quotelessJson,"record",()=>o.record,"set",()=>o.set,"setErrorMap",()=>t.setErrorMap,"strictObject",()=>o.strictObject,"string",()=>o.string,"symbol",()=>o.symbol,"transformer",()=>o.transformer,"tuple",()=>o.tuple,"undefined",()=>o.undefined,"union",()=>o.union,"unknown",()=>o.unknown,"util",()=>n.util,"void",()=>o.void],35907);var s=e.i(35907);e.s(["z",0,s],22632)},32828,e=>{"use strict";var t=e.i(66680),r=e.i(27356);let a="doccov_";function n(){let e=(0,r.nanoid)(32),t=`${a}${e}`,n=o(t),i=t.slice(0,12);return{key:t,hash:n,prefix:i}}function o(e){return(0,t.createHash)("sha256").update(e).digest("hex")}function i(e){return e.startsWith(a)&&e.length===a.length+32}e.s(["generateApiKey",()=>n,"hashApiKey",()=>o,"isValidKeyFormat",()=>i])},30682,e=>{"use strict";var t=e.i(32828);async function r(e,r){let a=e.headers.get("Authorization");if(!a)return{ok:!1,error:"API key required",status:401,docs:"https://docs.doccov.com/api-keys"};if(!a.startsWith("Bearer "))return{ok:!1,error:"Invalid Authorization header. Use: Bearer <api_key>",status:401};let n=a.slice(7);if(!(0,t.isValidKeyFormat)(n))return{ok:!1,error:"Invalid API key format",status:401};let o=(0,t.hashApiKey)(n),i=await r.selectFrom("api_keys").innerJoin("organizations","organizations.id","api_keys.orgId").where("api_keys.keyHash","=",o).where(e=>e.or([e("api_keys.expiresAt","is",null),e("api_keys.expiresAt",">",new Date)])).select(["api_keys.id as keyId","api_keys.orgId","api_keys.name as keyName","organizations.plan","organizations.aiCallsUsed","organizations.aiCallsResetAt"]).executeTakeFirst();return i?"free"===i.plan?{ok:!1,error:"API access requires a paid plan",status:403,upgrade:"https://doccov.com/pricing"}:(r.updateTable("api_keys").set({lastUsedAt:new Date}).where("id","=",i.keyId).execute().catch(console.error),{ok:!0,context:{apiKey:{id:i.keyId,orgId:i.orgId,name:i.keyName},org:{id:i.orgId,plan:i.plan,aiCallsUsed:i.aiCallsUsed,aiCallsResetAt:i.aiCallsResetAt}}}):{ok:!1,error:"Invalid or expired API key",status:401}}e.s(["validateApiKey",()=>r])},26575,e=>{"use strict";var t=e.i(22632);t.z.object({DATABASE_URL:t.z.string().url(),GITHUB_CLIENT_ID:t.z.string().min(1),GITHUB_CLIENT_SECRET:t.z.string().min(1),GITHUB_APP_ID:t.z.string().min(1).optional(),GITHUB_APP_PRIVATE_KEY:t.z.string().min(1).optional(),GITHUB_APP_WEBHOOK_SECRET:t.z.string().min(1).optional(),POLAR_ACCESS_TOKEN:t.z.string().min(1).optional(),POLAR_WEBHOOK_SECRET:t.z.string().min(1).optional(),POLAR_PRODUCT_TEAM:t.z.string().optional(),POLAR_PRODUCT_PRO:t.z.string().optional(),ANTHROPIC_API_KEY:t.z.string().min(1).optional(),OPENAI_API_KEY:t.z.string().min(1).optional(),SITE_URL:t.z.string().url().default("http://localhost:3000"),API_URL:t.z.string().url().default("http://localhost:3001"),SANDBOX_URL:t.z.string().url().optional(),SANDBOX_SECRET:t.z.string().min(1).optional(),NODE_ENV:t.z.enum(["development","production","test"]).default("development")}),e.i(30682);class r{store=new Map;get(e){let t=this.store.get(e);return t&&Date.now()>t.resetAt?void this.store.delete(e):t}increment(e,t){let r=Date.now(),a=this.get(e);if(a)return a.count++,a;let n={count:1,resetAt:r+t};return this.store.set(e,n),n}cleanup(){let e=Date.now();for(let[t,r]of this.store.entries())e>r.resetAt&&this.store.delete(t)}}let a=new r;"undefined"!=typeof setInterval&&setInterval(()=>a.cleanup(),6e4).unref?.(),e.i(32828),e.s([],26575)},66673,e=>e.a(async(t,r)=>{try{e.i(26575);var a=e.i(30682);e.i(33811);var n=e.i(42548),o=e.i(3985),i=t([o]);function s(){let e=new Date;return new Date(e.getFullYear(),e.getMonth()+1,1)}async function l(e){let t=await (0,a.validateApiKey)(e,o.db);if(!t.ok)return Response.json({error:t.error,docs:t.docs,upgrade:t.upgrade},{status:t.status});let{org:r}=t.context,i=(0,n.getPlanLimits)(r.plan).aiCallsPerMonth,l=new Date,d=!r.aiCallsResetAt||l>=r.aiCallsResetAt,u=r.aiCallsUsed,p=r.aiCallsResetAt||s();return d&&(u=0,p=s()),Response.json({plan:r.plan,used:u,limit:i===1/0?"unlimited":i,remaining:i===1/0?"unlimited":Math.max(0,i-u),resetAt:p.toISOString()})}[o]=i.then?(await i)():i,e.s(["GET",()=>l]),r()}catch(e){r(e)}},!1),48863,e=>e.a(async(t,r)=>{try{var a=e.i(47909),n=e.i(74017),o=e.i(96250),i=e.i(59756),s=e.i(61916),l=e.i(14444),d=e.i(37092),u=e.i(69741),p=e.i(16795),c=e.i(87718),m=e.i(95169),h=e.i(47587),y=e.i(66012),g=e.i(70101),R=e.i(26937),f=e.i(10372),v=e.i(93695);e.i(52474);var E=e.i(220),A=e.i(66673),Z=t([A]);[A]=Z.then?(await Z)():Z;let C=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/v1/ai/quota/route",pathname:"/api/v1/ai/quota",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/v1/ai/quota/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:b,workUnitAsyncStorage:T,serverHooks:I}=C;function P(){return(0,o.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:T})}async function x(e,t,r){C.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/v1/ai/quota/route";a=a.replace(/\/index$/,"")||"/";let o=await C.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:A,params:Z,nextConfig:P,parsedUrl:x,isDraftMode:b,prerenderManifest:T,routerServerContext:I,isOnDemandRevalidate:_,revalidateOnlyGenerated:w,resolvedPathname:N,clientReferenceManifest:k,serverActionsManifest:D}=o,O=(0,u.normalizeAppPath)(a),U=!!(T.dynamicRoutes[O]||T.routes[N]),S=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,x,!1):t.end("This page could not be found"),null);if(U&&!b){let e=!!T.routes[N],t=T.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(P.experimental.adapterPath)return await S();throw new v.NoFallbackError}}let M=null;!U||C.isDev||b||(M=N,M="/index"===M?"/":M);let z=!0===C.isDev||!U,H=U&&!z;D&&k&&(0,l.setReferenceManifestsSingleton)({page:a,clientReferenceManifest:k,serverActionsManifest:D,serverModuleMap:(0,d.createServerModuleMap)({serverActionsManifest:D})});let j=e.method||"GET",q=(0,s.getTracer)(),K=q.getActiveScopeSpan(),B={params:Z,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!P.experimental.authInterrupts},cacheComponents:!!P.cacheComponents,supportsDynamicResponse:z,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:P.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,I)},sharedContext:{buildId:A}},L=new p.NodeNextRequest(e),F=new p.NodeNextResponse(t),V=c.NextRequestAdapter.fromNodeNextRequest(L,(0,c.signalFromNodeResponse)(t));try{let o=async e=>C.handle(V,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=q.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${j} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${j} ${a}`)}),l=!!(0,i.getRequestMeta)(e,"minimalMode"),d=async i=>{var s,d;let u=async({previousCacheEntry:n})=>{try{if(!l&&_&&w&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await o(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let s=B.renderOpts.pendingWaitUntil;s&&r.waitUntil&&(r.waitUntil(s),s=void 0);let d=B.renderOpts.collectedTags;if(!U)return await (0,y.sendResponse)(L,F,a,B.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(a.headers);d&&(t[f.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,n=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==n?void 0:n.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:_})},I),t}},p=await C.handleResponse({req:e,nextConfig:P,cacheKey:M,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:_,revalidateOnlyGenerated:w,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:l});if(!U)return null;if((null==p||null==(s=p.value)?void 0:s.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(d=p.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",_?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),b&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,g.fromNodeOutgoingHttpHeaders)(p.value.headers);return l&&U||c.delete(f.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,R.getCacheControlHeader)(p.cacheControl)),await (0,y.sendResponse)(L,F,new Response(p.value.body,{headers:c,status:p.value.status||200})),null};K?await d(K):await q.withPropagatedContext(e.headers,()=>q.trace(m.BaseServerSpan.handleRequest,{spanName:`${j} ${a}`,kind:s.SpanKind.SERVER,attributes:{"http.method":j,"http.target":e.url}},d))}catch(t){if(t instanceof v.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:_})}),U)throw t;return await (0,y.sendResponse)(L,F,new Response(null,{status:500})),null}}e.s(["handler",()=>x,"patchFetch",()=>P,"routeModule",()=>C,"serverHooks",()=>I,"workAsyncStorage",()=>b,"workUnitAsyncStorage",()=>T]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__a7c07b09._.js.map