module.exports=[59094,36300,e=>{"use strict";function t(e){return void 0===e||void 0===e}function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function n(e){return"boolean"==typeof e}function o(e){return null===e}function s(e){return e instanceof Date}function a(e){return"bigint"==typeof e}function d(e){return"function"==typeof e}function p(e){return"object"==typeof e&&null!==e}function h(e){var t;if(!p(e)||"[object Object]"!==(null==(t=e)?void 0===t?"[object Undefined]":"[object Null]":N.call(t)))return!1;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}function u(e){return e[e.length-1]}function c(e){return Object.freeze(e)}function l(e){return f(e)?e:[e]}function f(e){return Array.isArray(e)}function m(e){return e}let N=Object.prototype.toString;e.s(["asArray",()=>l,"freeze",()=>c,"getLast",()=>u,"isBigInt",()=>a,"isBoolean",()=>n,"isDate",()=>s,"isFunction",()=>d,"isNull",()=>o,"isNumber",()=>i,"isObject",()=>p,"isPlainObject",()=>h,"isReadonlyArray",()=>f,"isString",()=>r,"isUndefined",()=>t,"noop",()=>m],59094);class y{nodeStack=[];#e=c({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this)});transformNode(e){if(!e)return e;this.nodeStack.push(e);let t=this.transformNodeImpl(e);return this.nodeStack.pop(),c(t)}transformNodeImpl(e){return this.#e[e.kind](e)}transformNodeList(e){return e?c(e.map(e=>this.transformNode(e))):e}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations),fetch:this.transformNode(e.fetch),top:this.transformNode(e.top)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:c([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),endModifiers:this.transformNodeList(e.endModifiers),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain),defaultValues:e.defaultValues,top:this.transformNode(e.top),output:this.transformNode(e.output)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),endModifiers:this.transformNodeList(e.endModifiers),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain),top:this.transformNode(e.top),output:this.transformNode(e.output)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),selectQuery:this.transformNode(e.selectQuery)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity,ifNotExists:e.ifNotExists}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),endModifiers:this.transformNodeList(e.endModifiers),with:this.transformNode(e.with),explain:this.transformNode(e.explain),limit:this.transformNode(e.limit),top:this.transformNode(e.top),output:this.transformNode(e.output)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where),nullsNotDistinct:e.nullsNotDistinct}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name),nullsNotDistinct:e.nullsNotDistinct}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),materialized:e.materialized,expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint),addIndex:this.transformNode(e.addIndex),dropIndex:this.transformNode(e.dropIndex)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier),of:this.transformNodeList(e.of)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,orderBy:this.transformNode(e.orderBy),filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformTuple(e){return{kind:"TupleNode",values:this.transformNodeList(e.values)}}transformMergeQuery(e){return{kind:"MergeQueryNode",into:this.transformNode(e.into),using:this.transformNode(e.using),whens:this.transformNodeList(e.whens),with:this.transformNode(e.with),top:this.transformNode(e.top),endModifiers:this.transformNodeList(e.endModifiers),output:this.transformNode(e.output)}}transformMatched(e){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e){return{kind:"AddIndexNode",name:this.transformNode(e.name),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists}}transformCast(e){return{kind:"CastNode",expression:this.transformNode(e.expression),dataType:this.transformNode(e.dataType)}}transformFetch(e){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount),modifier:e.modifier}}transformTop(e){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformOutput(e){return{kind:"OutputNode",selections:this.transformNodeList(e.selections)}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}e.s(["OperationNodeTransformer",()=>y],36300)},13286,e=>{"use strict";var t=e.i(59094),r=e.i(36300);class i extends r.OperationNodeTransformer{#t;constructor(e){super(),this.#t=e}transformIdentifier(e){return{...e=super.transformIdentifier(e),name:this.#t(e.name)}}}function n(e){return e>="0"&&e<="9"}function o(e){let t=new Map;return r=>{let i=t.get(r);return i||(i=e(r),t.set(r,i)),i}}class s{opt;#r;#t;#i;constructor(e={}){this.opt=e,this.#r=function({upperCase:e=!1}={}){return o(t=>{if(0===t.length)return t;e&&function(e){for(let t=1,r=e.length;t<r;++t){let r=e[t];if("_"!==r&&r!==r.toUpperCase())return!1}return!0}(t)&&(t=t.toLowerCase());let r=t[0];for(let e=1,i=t.length;e<i;++e){let i=t[e],n=t[e-1];"_"!==i&&("_"===n?r+=i.toUpperCase():r+=i)}return r})}(e),this.#t=function({upperCase:e=!1,underscoreBeforeDigits:t=!1,underscoreBetweenUppercaseLetters:r=!1}={}){return o(i=>{if(0===i.length)return i;let o=i.toUpperCase(),s=i.toLowerCase(),a=s[0];for(let e=1,d=i.length;e<d;++e){let d=i[e],p=i[e-1],h=o[e],u=o[e-1],c=s[e],l=s[e-1];if(t&&n(d)&&!n(p)&&!a.endsWith("_")){a+="_"+d;continue}if(d===h&&h!==c){let e=p===u&&u!==l;r||!e?a+="_"+c:a+=c}else a+=d}return e?a.toUpperCase():a})}(e),this.#i=new i(this.snakeCase.bind(this))}transformQuery(e){return this.#i.transformNode(e.node)}async transformResult(e){return e.result.rows&&Array.isArray(e.result.rows)?{...e.result,rows:e.result.rows.map(e=>this.mapRow(e))}:e.result}mapRow(e){return Object.keys(e).reduce((t,r)=>{let i=e[r];return Array.isArray(i)?i=i.map(e=>a(e,this.opt)?this.mapRow(e):e):a(i,this.opt)&&(i=this.mapRow(i)),t[this.camelCase(r)]=i,t},{})}snakeCase(e){return this.#t(e)}camelCase(e){return this.#r(e)}}function a(e,r){return(0,t.isPlainObject)(e)&&!r?.maintainNestedObjectKeys}e.s(["CamelCasePlugin",()=>s],13286)},61761,69972,66586,50495,44473,80727,81196,44550,70445,1765,58390,93846,4196,29961,88986,54996,48490,80182,91494,92868,26951,99948,52564,42856,78800,39504,25176,2757,91658,75670,69918,92465,78655,e=>{"use strict";var t=e.i(59094);let r=(0,t.freeze)({is:e=>"IdentifierNode"===e.kind,create:e=>(0,t.freeze)({kind:"IdentifierNode",name:e})});e.s(["IdentifierNode",0,r],61761);let i=(0,t.freeze)({is:e=>"CreateTableNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateTableNode",table:e,columns:(0,t.freeze)([])}),cloneWithColumn:(e,r)=>(0,t.freeze)({...e,columns:(0,t.freeze)([...e.columns,r])}),cloneWithConstraint:(e,r)=>(0,t.freeze)({...e,constraints:e.constraints?(0,t.freeze)([...e.constraints,r]):(0,t.freeze)([r])}),cloneWithFrontModifier:(e,r)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,r]):(0,t.freeze)([r])}),cloneWithEndModifier:(e,r)=>(0,t.freeze)({...e,endModifiers:e.endModifiers?(0,t.freeze)([...e.endModifiers,r]):(0,t.freeze)([r])}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["CreateTableNode",0,i,"ON_COMMIT_ACTIONS",0,["preserve rows","delete rows","drop"]],69972);let n=(0,t.freeze)({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>(0,t.freeze)({kind:"SchemableIdentifierNode",identifier:r.create(e)}),createWithSchema:(e,i)=>(0,t.freeze)({kind:"SchemableIdentifierNode",schema:r.create(e),identifier:r.create(i)})});e.s(["SchemableIdentifierNode",0,n],66586),e.s(["parseAliasedTable",()=>t0,"parseTable",()=>t1,"parseTableExpression",()=>tZ,"parseTableExpressionOrList",()=>tY],92465);let o=(0,t.freeze)({is:e=>"AliasNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"AliasNode",node:e,alias:r})});e.s(["AliasNode",0,o],50495);let s=(0,t.freeze)({is:e=>"TableNode"===e.kind,create:e=>(0,t.freeze)({kind:"TableNode",table:n.create(e)}),createWithSchema:(e,r)=>(0,t.freeze)({kind:"TableNode",table:n.createWithSchema(e,r)})});function a(e){return(0,t.isObject)(e)&&(0,t.isFunction)(e.toOperationNode)}e.s(["isExpressionOrFactory",()=>tX,"parseAliasedExpression",()=>tH,"parseExpression",()=>tG],69918),e.s(["isOperationNodeSource",()=>a],44473);let d=(0,t.freeze)({is:e=>"SelectModifierNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"SelectModifierNode",modifier:e,of:r}),createWithExpression:e=>(0,t.freeze)({kind:"SelectModifierNode",rawModifier:e})}),p=(0,t.freeze)({is:e=>"AndNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"AndNode",left:e,right:r})}),h=(0,t.freeze)({is:e=>"OrNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"OrNode",left:e,right:r})}),u=(0,t.freeze)({is:e=>"OnNode"===e.kind,create:e=>(0,t.freeze)({kind:"OnNode",on:e}),cloneWithOperation:(e,r,i)=>(0,t.freeze)({...e,on:"And"===r?p.create(e.on,i):h.create(e.on,i)})}),c=(0,t.freeze)({is:e=>"JoinNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"JoinNode",joinType:e,table:r,on:void 0}),createWithOn:(e,r,i)=>(0,t.freeze)({kind:"JoinNode",joinType:e,table:r,on:u.create(i)}),cloneWithOn:(e,r)=>(0,t.freeze)({...e,on:e.on?u.cloneWithOperation(e.on,"And",r):u.create(r)})});e.s(["parseFilterList",()=>Z,"parseFilterObject",()=>Y,"parseReferentialBinaryOperation",()=>X,"parseValueBinaryOperation",()=>H,"parseValueBinaryOperationOrExpression",()=>G],54996);let l=(0,t.freeze)({is:e=>"BinaryOperationNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"BinaryOperationNode",leftOperand:e,operator:r,rightOperand:i})}),f=["->","->>"],m=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||",...f,"not","-","exists","not exists","between","between symmetric"],N=(0,t.freeze)({is:e=>"OperatorNode"===e.kind,create:e=>(0,t.freeze)({kind:"OperatorNode",operator:e})});function y(e){return(0,t.isString)(e)&&f.includes(e)}e.s(["OPERATORS",0,m,"OperatorNode",0,N,"isJSONOperator",()=>y],80727),e.s(["parseAliasedStringReference",()=>Q,"parseColumnName",()=>P,"parseJSONReference",()=>D,"parseOrderedColumnName",()=>R,"parseReferenceExpression",()=>B,"parseReferenceExpressionOrList",()=>E,"parseSimpleReferenceExpression",()=>A,"parseStringReference",()=>L],58390);let w=(0,t.freeze)({is:e=>"ColumnNode"===e.kind,create:e=>(0,t.freeze)({kind:"ColumnNode",column:r.create(e)})});e.s(["ColumnNode",0,w],81196);let g=(0,t.freeze)({is:e=>"SelectAllNode"===e.kind,create:()=>(0,t.freeze)({kind:"SelectAllNode"})});e.s(["SelectAllNode",0,g],44550);let v=(0,t.freeze)({is:e=>"ReferenceNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ReferenceNode",table:r,column:e}),createSelectAll:e=>(0,t.freeze)({kind:"ReferenceNode",table:e,column:g.create()})});e.s(["DynamicReferenceBuilder",()=>x,"isDynamicReferenceBuilder",()=>b],70445);class x{#n;get dynamicReference(){return this.#n}get refType(){}constructor(e){this.#n=e}toOperationNode(){return A(this.#n)}}function b(e){return(0,t.isObject)(e)&&a(e)&&(0,t.isString)(e.dynamicReference)}let O=(0,t.freeze)({is:e=>"OrderByItemNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"OrderByItemNode",orderBy:e,direction:r})}),W=(0,t.freeze)({is:e=>"RawNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"RawNode",sqlFragments:(0,t.freeze)(e),parameters:(0,t.freeze)(r)}),createWithSql:e=>W.create([e],[]),createWithChild:e=>W.create(["",""],[e]),createWithChildren:e=>W.create(Array(e.length+1).fill(""),e)});function C(e){return"asc"===e||"desc"===e}function q(e){if(2===e.length)return[z(e[0],e[1])];if(1===e.length){let[t]=e;return Array.isArray(t)?t.map(e=>z(e)):[z(t)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function z(e,t){let r=function(e){if(tX(e))return tG(e);if(b(e))return e.toOperationNode();let[t,r]=e.split(" ");if(r){if(!C(r))throw Error(`Invalid order by direction: ${r}`);return O.create(L(t),k(r))}return L(e)}(e);if(O.is(r)){if(t)throw Error("Cannot specify direction twice!");return r}return O.create(r,k(t))}function k(e){if(e)return"asc"===e||"desc"===e?W.createWithSql(e):e.toOperationNode()}e.s(["RawNode",0,W],1765);let I=(0,t.freeze)({is:e=>"JSONReferenceNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"JSONReferenceNode",reference:e,traversal:r}),cloneWithTraversal:(e,r)=>(0,t.freeze)({...e,traversal:r})}),T=(0,t.freeze)({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>(0,t.freeze)({kind:"JSONOperatorChainNode",operator:e,values:(0,t.freeze)([])}),cloneWithValue:(e,r)=>(0,t.freeze)({...e,values:(0,t.freeze)([...e.values,r])})}),S=(0,t.freeze)({is:e=>"JSONPathNode"===e.kind,create:e=>(0,t.freeze)({kind:"JSONPathNode",inOperator:e,pathLegs:(0,t.freeze)([])}),cloneWithLeg:(e,r)=>(0,t.freeze)({...e,pathLegs:(0,t.freeze)([...e.pathLegs,r])})});function A(e){return(0,t.isString)(e)?L(e):e.toOperationNode()}function E(e){return(0,t.isReadonlyArray)(e)?e.map(e=>B(e)):[B(e)]}function B(e){return tX(e)?tG(e):A(e)}function D(e,t){let r=L(e);if(y(t))return I.create(r,T.create(N.create(t)));let i=t.slice(0,-1);if(y(i))return I.create(r,S.create(N.create(i)));throw Error(`Invalid JSON operator: ${t}`)}function L(e){if(!e.includes("."))return v.create(w.create(e));let t=e.split(".").map(M);if(3===t.length)return function(e){let[t,r,i]=e;return v.create(w.create(i),s.createWithSchema(t,r))}(t);if(2===t.length)return function(e){let[t,r]=e;return v.create(w.create(r),s.create(t))}(t);throw Error(`invalid column reference ${e}`)}function Q(e){let t=" as ";if(!e.includes(t))return L(e);{let[i,n]=e.split(t).map(M);return o.create(L(i),r.create(n))}}function P(e){return w.create(e)}function R(e){if(!e.includes(" "))return P(e);{let[t,r]=e.split(" ").map(M);if(!C(r))throw Error(`invalid order direction "${r}" next to "${t}"`);return q([t,r])[0]}}function M(e){return e.trim()}e.s(["isSafeImmediateValue",()=>j,"parseSafeImmediateValue",()=>_,"parseValueExpression",()=>$,"parseValueExpressionOrList",()=>J],29961);let F=(0,t.freeze)({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>(0,t.freeze)({kind:"PrimitiveValueListNode",values:(0,t.freeze)([...e])})}),U=(0,t.freeze)({is:e=>"ValueListNode"===e.kind,create:e=>(0,t.freeze)({kind:"ValueListNode",values:(0,t.freeze)(e)})});e.s(["ValueListNode",0,U],93846);let V=(0,t.freeze)({is:e=>"ValueNode"===e.kind,create:e=>(0,t.freeze)({kind:"ValueNode",value:e}),createImmediate:e=>(0,t.freeze)({kind:"ValueNode",value:e,immediate:!0})});function J(e){var r;return(0,t.isReadonlyArray)(e)?(r=e).some(tX)?U.create(r.map(e=>$(e))):F.create(r):$(e)}function $(e){return tX(e)?tG(e):V.create(e)}function j(e){return(0,t.isNumber)(e)||(0,t.isBoolean)(e)||(0,t.isNull)(e)}function _(e){if(!j(e))throw Error(`unsafe immediate value ${JSON.stringify(e)}`);return V.createImmediate(e)}e.s(["ValueNode",0,V],4196);let K=(0,t.freeze)({is:e=>"ParensNode"===e.kind,create:e=>(0,t.freeze)({kind:"ParensNode",node:e})});function G(e){if(3===e.length)return H(e[0],e[1],e[2]);if(1===e.length)return $(e[0]);throw Error(`invalid arguments: ${JSON.stringify(e)}`)}function H(e,t,r){var i;return("is"===(i=t)||"is not"===i)&&ee(r)?l.create(B(e),et(t),V.createImmediate(r)):l.create(B(e),et(t),J(r))}function X(e,t,r){return l.create(B(e),et(t),B(r))}function Y(e,r){return Z(Object.entries(e).filter(([,e])=>!(0,t.isUndefined)(e)).map(([e,t])=>H(e,ee(t)?"is":"=",t)),r)}function Z(e,t,r=!0){let i="and"===t?p.create:h.create;if(0===e.length)return l.create(V.createImmediate(1),N.create("="),V.createImmediate(+("and"===t)));let n=er(e[0]);for(let t=1;t<e.length;++t)n=i(n,er(e[t]));return e.length>1&&r?K.create(n):n}function ee(e){return(0,t.isNull)(e)||(0,t.isBoolean)(e)}function et(e){if((0,t.isString)(e)&&m.includes(e))return N.create(e);if(a(e))return e.toOperationNode();throw Error(`invalid operator ${JSON.stringify(e)}`)}function er(e){return a(e)?e.toOperationNode():e}e.s(["ParensNode",0,K],88986);let ei=(0,t.freeze)({is:e=>"OrderByNode"===e.kind,create:e=>(0,t.freeze)({kind:"OrderByNode",items:(0,t.freeze)([...e])}),cloneWithItems:(e,r)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...r])})}),en=(0,t.freeze)({is:e=>"PartitionByNode"===e.kind,create:e=>(0,t.freeze)({kind:"PartitionByNode",items:(0,t.freeze)(e)}),cloneWithItems:(e,r)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...r])})}),eo=(0,t.freeze)({is:e=>"OverNode"===e.kind,create:()=>(0,t.freeze)({kind:"OverNode"}),cloneWithOrderByItems:(e,r)=>(0,t.freeze)({...e,orderBy:e.orderBy?ei.cloneWithItems(e.orderBy,r):ei.create(r)}),cloneWithPartitionByItems:(e,r)=>(0,t.freeze)({...e,partitionBy:e.partitionBy?en.cloneWithItems(e.partitionBy,r):en.create(r)})}),es=(0,t.freeze)({is:e=>"FromNode"===e.kind,create:e=>(0,t.freeze)({kind:"FromNode",froms:(0,t.freeze)(e)}),cloneWithFroms:(e,r)=>(0,t.freeze)({...e,froms:(0,t.freeze)([...e.froms,...r])})}),ea=(0,t.freeze)({is:e=>"GroupByNode"===e.kind,create:e=>(0,t.freeze)({kind:"GroupByNode",items:(0,t.freeze)(e)}),cloneWithItems:(e,r)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...r])})}),ed=(0,t.freeze)({is:e=>"HavingNode"===e.kind,create:e=>(0,t.freeze)({kind:"HavingNode",having:e}),cloneWithOperation:(e,r,i)=>(0,t.freeze)({...e,having:"And"===r?p.create(e.having,i):h.create(e.having,i)})}),ep=(0,t.freeze)({is:e=>"SelectQueryNode"===e.kind,create:e=>(0,t.freeze)({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,r)=>(0,t.freeze)({kind:"SelectQueryNode",from:es.create(e),...r&&{with:r}}),cloneWithSelections:(e,r)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...r]):(0,t.freeze)(r)}),cloneWithDistinctOn:(e,r)=>(0,t.freeze)({...e,distinctOn:e.distinctOn?(0,t.freeze)([...e.distinctOn,...r]):(0,t.freeze)(r)}),cloneWithFrontModifier:(e,r)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,r]):(0,t.freeze)([r])}),cloneWithOrderByItems:(e,r)=>(0,t.freeze)({...e,orderBy:e.orderBy?ei.cloneWithItems(e.orderBy,r):ei.create(r)}),cloneWithGroupByItems:(e,r)=>(0,t.freeze)({...e,groupBy:e.groupBy?ea.cloneWithItems(e.groupBy,r):ea.create(r)}),cloneWithLimit:(e,r)=>(0,t.freeze)({...e,limit:r}),cloneWithOffset:(e,r)=>(0,t.freeze)({...e,offset:r}),cloneWithFetch:(e,r)=>(0,t.freeze)({...e,fetch:r}),cloneWithHaving:(e,r)=>(0,t.freeze)({...e,having:e.having?ed.cloneWithOperation(e.having,"And",r):ed.create(r)}),cloneWithSetOperations:(e,r)=>(0,t.freeze)({...e,setOperations:e.setOperations?(0,t.freeze)([...e.setOperations,...r]):(0,t.freeze)([...r])}),cloneWithoutSelections:e=>(0,t.freeze)({...e,selections:[]}),cloneWithoutLimit:e=>(0,t.freeze)({...e,limit:void 0}),cloneWithoutOffset:e=>(0,t.freeze)({...e,offset:void 0}),cloneWithoutOrderBy:e=>(0,t.freeze)({...e,orderBy:void 0}),cloneWithoutGroupBy:e=>(0,t.freeze)({...e,groupBy:void 0})});function eh(e,t){Object.defineProperties(e.prototype,{then:{enumerable:!1,value:()=>{throw Error(t)}}})}e.s(["preventAwait",()=>eh],48490);class eu{#o;constructor(e){this.#o=(0,t.freeze)(e)}on(...e){return new eu({...this.#o,joinNode:c.cloneWithOn(this.#o.joinNode,G(e))})}onRef(e,t,r){return new eu({...this.#o,joinNode:c.cloneWithOn(this.#o.joinNode,X(e,t,r))})}onTrue(){return new eu({...this.#o,joinNode:c.cloneWithOn(this.#o.joinNode,W.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#o.joinNode}}eh(eu,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");let ec=(0,t.freeze)({is:e=>"PartitionByItemNode"===e.kind,create:e=>(0,t.freeze)({kind:"PartitionByItemNode",partitionBy:e})});class el{#o;constructor(e){this.#o=(0,t.freeze)(e)}orderBy(e,t){return new el({overNode:eo.cloneWithOrderByItems(this.#o.overNode,q([e,t]))})}partitionBy(e){return new el({overNode:eo.cloneWithPartitionByItems(this.#o.overNode,E(e).map(ec.create))})}$call(e){return e(this)}toOperationNode(){return this.#o.overNode}}eh(el,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query."),e.s(["QueryCreator",()=>tm],78800);let ef=(0,t.freeze)({is:e=>"SelectionNode"===e.kind,create:e=>(0,t.freeze)({kind:"SelectionNode",selection:e}),createSelectAll:()=>(0,t.freeze)({kind:"SelectionNode",selection:g.create()}),createSelectAllFromTable:e=>(0,t.freeze)({kind:"SelectionNode",selection:v.createSelectAll(e)})});function em(e){return(0,t.isFunction)(e)?em(e(tK())):(0,t.isReadonlyArray)(e)?e.map(e=>eN(e)):[eN(e)]}function eN(e){return(0,t.isString)(e)?ef.create(Q(e)):b(e)?ef.create(e.toOperationNode()):ef.create(tH(e))}function ey(e){return e?Array.isArray(e)?e.map(ew):[ew(e)]:[ef.createSelectAll()]}function ew(e){if((0,t.isString)(e))return ef.createSelectAllFromTable(t1(e));throw Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}let eg=(0,t.freeze)({is:e=>"ValuesNode"===e.kind,create:e=>(0,t.freeze)({kind:"ValuesNode",values:(0,t.freeze)(e)})}),ev=(0,t.freeze)({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>(0,t.freeze)({kind:"DefaultInsertValueNode"})});function ex(e){var r;let i,n=(0,t.isFunction)(e)?e(tK()):e;return i=function(e){let t=new Map;for(let r of e)for(let e of Object.keys(r))t.has(e)||void 0===r[e]||t.set(e,t.size);return t}(r=(0,t.isReadonlyArray)(n)?n:(0,t.freeze)([n])),[(0,t.freeze)([...i.keys()].map(w.create)),eg.create(r.map(e=>(function(e,r){let i=Object.keys(e),n=Array.from({length:r.size}),o=!1,s=i.length;for(let a of i){let i=r.get(a);if((0,t.isUndefined)(i)){s--;continue}let d=e[a];((0,t.isUndefined)(d)||tX(d))&&(o=!0),n[i]=d}if(s<r.size||o){let e=ev.create();return U.create(n.map(r=>(0,t.isUndefined)(r)?e:$(r)))}return F.create(n)})(e,i)))]}let eb=(0,t.freeze)({is:e=>"InsertQueryNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"InsertQueryNode",into:e,...r&&{with:r},replace:i}),createWithoutInto:()=>(0,t.freeze)({kind:"InsertQueryNode"}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["InsertQueryNode",0,eb],80182);let eO=(0,t.freeze)({is:e=>"UpdateQueryNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"UpdateQueryNode",table:e,...r&&{with:r}}),createWithoutTable:()=>(0,t.freeze)({kind:"UpdateQueryNode"}),cloneWithFromItems:(e,r)=>(0,t.freeze)({...e,from:e.from?es.cloneWithFroms(e.from,r):es.create(r)}),cloneWithUpdates:(e,r)=>(0,t.freeze)({...e,updates:e.updates?(0,t.freeze)([...e.updates,...r]):r}),cloneWithLimit:(e,r)=>(0,t.freeze)({...e,limit:r})}),eW=(0,t.freeze)({is:e=>"UsingNode"===e.kind,create:e=>(0,t.freeze)({kind:"UsingNode",tables:(0,t.freeze)(e)}),cloneWithTables:(e,r)=>(0,t.freeze)({...e,tables:(0,t.freeze)([...e.tables,...r])})}),eC=(0,t.freeze)({is:e=>"DeleteQueryNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"DeleteQueryNode",from:es.create(e),...r&&{with:r}}),cloneWithOrderByItems:(e,r)=>(0,t.freeze)({...e,orderBy:e.orderBy?ei.cloneWithItems(e.orderBy,r):ei.create(r)}),cloneWithoutOrderBy:e=>(0,t.freeze)({...e,orderBy:void 0}),cloneWithLimit:(e,r)=>(0,t.freeze)({...e,limit:r}),cloneWithoutLimit:e=>(0,t.freeze)({...e,limit:void 0}),cloneWithUsing:(e,r)=>(0,t.freeze)({...e,using:void 0!==e.using?eW.cloneWithTables(e.using,r):eW.create(r)})}),eq=(0,t.freeze)({is:e=>"WhereNode"===e.kind,create:e=>(0,t.freeze)({kind:"WhereNode",where:e}),cloneWithOperation:(e,r,i)=>(0,t.freeze)({...e,where:"And"===r?p.create(e.where,i):h.create(e.where,i)})}),ez=(0,t.freeze)({is:e=>"ReturningNode"===e.kind,create:e=>(0,t.freeze)({kind:"ReturningNode",selections:(0,t.freeze)(e)}),cloneWithSelections:(e,r)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...r]):(0,t.freeze)(r)})}),ek=(0,t.freeze)({is:e=>"ExplainNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ExplainNode",format:e,options:r})}),eI=(0,t.freeze)({is:e=>"WhenNode"===e.kind,create:e=>(0,t.freeze)({kind:"WhenNode",condition:e}),cloneWithResult:(e,r)=>(0,t.freeze)({...e,result:r})}),eT=(0,t.freeze)({is:e=>"MergeQueryNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"MergeQueryNode",into:e,...r&&{with:r}}),cloneWithUsing:(e,r)=>(0,t.freeze)({...e,using:r}),cloneWithWhen:(e,r)=>(0,t.freeze)({...e,whens:e.whens?(0,t.freeze)([...e.whens,r]):(0,t.freeze)([r])}),cloneWithThen:(e,r)=>(0,t.freeze)({...e,whens:e.whens?(0,t.freeze)([...e.whens.slice(0,-1),eI.cloneWithResult(e.whens[e.whens.length-1],r)]):void 0})});e.s(["MergeQueryNode",0,eT],91494);let eS=(0,t.freeze)({is:e=>"OutputNode"===e.kind,create:e=>(0,t.freeze)({kind:"OutputNode",selections:(0,t.freeze)(e)}),cloneWithSelections:(e,r)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...r]):(0,t.freeze)(r)})}),eA=(0,t.freeze)({is:e=>ep.is(e)||eb.is(e)||eO.is(e)||eC.is(e)||eT.is(e),cloneWithEndModifier:(e,r)=>(0,t.freeze)({...e,endModifiers:e.endModifiers?(0,t.freeze)([...e.endModifiers,r]):(0,t.freeze)([r])}),cloneWithWhere:(e,r)=>(0,t.freeze)({...e,where:e.where?eq.cloneWithOperation(e.where,"And",r):eq.create(r)}),cloneWithJoin:(e,r)=>(0,t.freeze)({...e,joins:e.joins?(0,t.freeze)([...e.joins,r]):(0,t.freeze)([r])}),cloneWithReturning:(e,r)=>(0,t.freeze)({...e,returning:e.returning?ez.cloneWithSelections(e.returning,r):ez.create(r)}),cloneWithoutReturning:e=>(0,t.freeze)({...e,returning:void 0}),cloneWithoutWhere:e=>(0,t.freeze)({...e,where:void 0}),cloneWithExplain:(e,r,i)=>(0,t.freeze)({...e,explain:ek.create(r,i?.toOperationNode())}),cloneWithTop:(e,r)=>(0,t.freeze)({...e,top:r}),cloneWithOutput:(e,r)=>(0,t.freeze)({...e,output:e.output?eS.cloneWithSelections(e.output,r):eS.create(r)})});e.s(["QueryNode",0,eA],92868);let eE=(0,t.freeze)({is:e=>"ColumnUpdateNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ColumnUpdateNode",column:e,value:r})});function eB(e){return Object.entries((0,t.isFunction)(e)?e(tK()):e).filter(([e,t])=>void 0!==t).map(([e,t])=>eE.create(w.create(e),$(t)))}let eD=(0,t.freeze)({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>(0,t.freeze)({kind:"OnDuplicateKeyNode",updates:e})});class eL{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}class eQ extends Error{node;constructor(e){super("no result"),this.node=e}}function eP(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}let eR=(0,t.freeze)({is:e=>"OnConflictNode"===e.kind,create:()=>(0,t.freeze)({kind:"OnConflictNode"}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r}),cloneWithIndexWhere:(e,r)=>(0,t.freeze)({...e,indexWhere:e.indexWhere?eq.cloneWithOperation(e.indexWhere,"And",r):eq.create(r)}),cloneWithIndexOrWhere:(e,r)=>(0,t.freeze)({...e,indexWhere:e.indexWhere?eq.cloneWithOperation(e.indexWhere,"Or",r):eq.create(r)}),cloneWithUpdateWhere:(e,r)=>(0,t.freeze)({...e,updateWhere:e.updateWhere?eq.cloneWithOperation(e.updateWhere,"And",r):eq.create(r)}),cloneWithUpdateOrWhere:(e,r)=>(0,t.freeze)({...e,updateWhere:e.updateWhere?eq.cloneWithOperation(e.updateWhere,"Or",r):eq.create(r)}),cloneWithoutIndexWhere:e=>(0,t.freeze)({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>(0,t.freeze)({...e,updateWhere:void 0})});class eM{#o;constructor(e){this.#o=(0,t.freeze)(e)}column(e){let r=w.create(e);return new eM({...this.#o,onConflictNode:eR.cloneWith(this.#o.onConflictNode,{columns:this.#o.onConflictNode.columns?(0,t.freeze)([...this.#o.onConflictNode.columns,r]):(0,t.freeze)([r])})})}columns(e){let r=e.map(w.create);return new eM({...this.#o,onConflictNode:eR.cloneWith(this.#o.onConflictNode,{columns:this.#o.onConflictNode.columns?(0,t.freeze)([...this.#o.onConflictNode.columns,...r]):(0,t.freeze)(r)})})}constraint(e){return new eM({...this.#o,onConflictNode:eR.cloneWith(this.#o.onConflictNode,{constraint:r.create(e)})})}expression(e){return new eM({...this.#o,onConflictNode:eR.cloneWith(this.#o.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new eM({...this.#o,onConflictNode:eR.cloneWithIndexWhere(this.#o.onConflictNode,G(e))})}whereRef(e,t,r){return new eM({...this.#o,onConflictNode:eR.cloneWithIndexWhere(this.#o.onConflictNode,X(e,t,r))})}clearWhere(){return new eM({...this.#o,onConflictNode:eR.cloneWithoutIndexWhere(this.#o.onConflictNode)})}doNothing(){return new eF({...this.#o,onConflictNode:eR.cloneWith(this.#o.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new eU({...this.#o,onConflictNode:eR.cloneWith(this.#o.onConflictNode,{updates:eB(e)})})}$call(e){return e(this)}}eh(eM,"don't await OnConflictBuilder instances.");class eF{#o;constructor(e){this.#o=(0,t.freeze)(e)}toOperationNode(){return this.#o.onConflictNode}}eh(eF,"don't await OnConflictDoNothingBuilder instances.");class eU{#o;constructor(e){this.#o=(0,t.freeze)(e)}where(...e){return new eU({...this.#o,onConflictNode:eR.cloneWithUpdateWhere(this.#o.onConflictNode,G(e))})}whereRef(e,t,r){return new eU({...this.#o,onConflictNode:eR.cloneWithUpdateWhere(this.#o.onConflictNode,X(e,t,r))})}clearWhere(){return new eU({...this.#o,onConflictNode:eR.cloneWithoutUpdateWhere(this.#o.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#o.onConflictNode}}eh(eU,"don't await OnConflictUpdateBuilder instances.");let eV=(0,t.freeze)({is:e=>"TopNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"TopNode",expression:e,modifiers:r})});function eJ(e,r){var i;if(!(0,t.isNumber)(e)&&!(0,t.isBigInt)(e))throw Error(`Invalid top expression: ${e}`);if(!(0,t.isUndefined)(r)&&"percent"!==(i=r)&&"with ties"!==i&&"percent with ties"!==i)throw Error(`Invalid top modifiers: ${r}`);return eV.create(e,r)}class e${#o;constructor(e){this.#o=(0,t.freeze)(e)}values(e){let[t,r]=ex(e);return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{columns:t,values:r})})}columns(e){return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{columns:(0,t.freeze)(e.map(w.create))})})}expression(e){return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{values:tG(e)})})}defaultValues(){return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{defaultValues:!0})})}modifyEnd(e){return new e$({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,e.toOperationNode())})}ignore(){return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{ignore:!0})})}top(e,t){return new e$({...this.#o,queryNode:eA.cloneWithTop(this.#o.queryNode,eJ(e,t))})}onConflict(e){return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{onConflict:e(new eM({onConflictNode:eR.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new e$({...this.#o,queryNode:eb.cloneWith(this.#o.queryNode,{onDuplicateKey:eD.create(eB(e))})})}returning(e){return new e$({...this.#o,queryNode:eA.cloneWithReturning(this.#o.queryNode,em(e))})}returningAll(){return new e$({...this.#o,queryNode:eA.cloneWithReturning(this.#o.queryNode,ey())})}output(e){return new e$({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,em(e))})}outputAll(e){return new e$({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,ey(e))})}clearReturning(){return new e$({...this.#o,queryNode:eA.cloneWithoutReturning(this.#o.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new e$({...this.#o})}$castTo(){return new e$(this.#o)}$narrowType(){return new e$(this.#o)}$assertType(){return new e$(this.#o)}withPlugin(e){return new e$({...this.#o,executor:this.#o.executor.withPlugin(e)})}toOperationNode(){return this.#o.executor.transformQuery(this.#o.queryNode,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){let e=this.compile(),t=await this.#o.executor.executeQuery(e,this.#o.queryId),{adapter:r}=this.#o.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new eL(t.insertId,t.numAffectedRows??t.numUpdatedOrDeletedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=eQ){let t=await this.executeTakeFirst();if(void 0===t)throw eP(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#o.executor.stream(t,e,this.#o.queryId))yield*r.rows}async explain(e,t){let r=new e$({...this.#o,queryNode:eA.cloneWithExplain(this.#o.queryNode,e,t)});return await r.execute()}}eh(e$,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class ej{numDeletedRows;constructor(e){this.numDeletedRows=e}}let e_=(0,t.freeze)({is:e=>"LimitNode"===e.kind,create:e=>(0,t.freeze)({kind:"LimitNode",limit:e})});class eK{#o;constructor(e){this.#o=(0,t.freeze)(e)}where(...e){return new eK({...this.#o,queryNode:eA.cloneWithWhere(this.#o.queryNode,G(e))})}whereRef(e,t,r){return new eK({...this.#o,queryNode:eA.cloneWithWhere(this.#o.queryNode,X(e,t,r))})}clearWhere(){return new eK({...this.#o,queryNode:eA.cloneWithoutWhere(this.#o.queryNode)})}top(e,t){return new eK({...this.#o,queryNode:eA.cloneWithTop(this.#o.queryNode,eJ(e,t))})}using(e){return new eK({...this.#o,queryNode:eC.cloneWithUsing(this.#o.queryNode,tY(e))})}innerJoin(...e){return new eK({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("InnerJoin",e))})}leftJoin(...e){return new eK({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("LeftJoin",e))})}rightJoin(...e){return new eK({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("RightJoin",e))})}fullJoin(...e){return new eK({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("FullJoin",e))})}returning(e){return new eK({...this.#o,queryNode:eA.cloneWithReturning(this.#o.queryNode,em(e))})}returningAll(e){return new eK({...this.#o,queryNode:eA.cloneWithReturning(this.#o.queryNode,ey(e))})}output(e){return new eK({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,em(e))})}outputAll(e){return new eK({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,ey(e))})}clearReturning(){return new eK({...this.#o,queryNode:eA.cloneWithoutReturning(this.#o.queryNode)})}clearLimit(){return new eK({...this.#o,queryNode:eC.cloneWithoutLimit(this.#o.queryNode)})}clearOrderBy(){return new eK({...this.#o,queryNode:eC.cloneWithoutOrderBy(this.#o.queryNode)})}orderBy(e,t){return new eK({...this.#o,queryNode:eC.cloneWithOrderByItems(this.#o.queryNode,q([e,t]))})}limit(e){return new eK({...this.#o,queryNode:eC.cloneWithLimit(this.#o.queryNode,e_.create($(e)))})}modifyEnd(e){return new eK({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,e.toOperationNode())})}$call(e){return e(this)}$if(e,t){return e?t(this):new eK({...this.#o})}$castTo(){return new eK(this.#o)}$narrowType(){return new eK(this.#o)}$assertType(){return new eK(this.#o)}withPlugin(e){return new eK({...this.#o,executor:this.#o.executor.withPlugin(e)})}toOperationNode(){return this.#o.executor.transformQuery(this.#o.queryNode,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){let e=this.compile(),t=await this.#o.executor.executeQuery(e,this.#o.queryId),{adapter:r}=this.#o.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new ej(t.numAffectedRows??t.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=eQ){let t=await this.executeTakeFirst();if(void 0===t)throw eP(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#o.executor.stream(t,e,this.#o.queryId))yield*r.rows}async explain(e,t){let r=new eK({...this.#o,queryNode:eA.cloneWithExplain(this.#o.queryNode,e,t)});return await r.execute()}}eh(eK,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class eG{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class eH{#o;constructor(e){this.#o=(0,t.freeze)(e)}where(...e){return new eH({...this.#o,queryNode:eA.cloneWithWhere(this.#o.queryNode,G(e))})}whereRef(e,t,r){return new eH({...this.#o,queryNode:eA.cloneWithWhere(this.#o.queryNode,X(e,t,r))})}clearWhere(){return new eH({...this.#o,queryNode:eA.cloneWithoutWhere(this.#o.queryNode)})}top(e,t){return new eH({...this.#o,queryNode:eA.cloneWithTop(this.#o.queryNode,eJ(e,t))})}from(e){return new eH({...this.#o,queryNode:eO.cloneWithFromItems(this.#o.queryNode,tY(e))})}innerJoin(...e){return new eH({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("InnerJoin",e))})}leftJoin(...e){return new eH({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("LeftJoin",e))})}rightJoin(...e){return new eH({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("RightJoin",e))})}fullJoin(...e){return new eH({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("FullJoin",e))})}limit(e){return new eH({...this.#o,queryNode:eO.cloneWithLimit(this.#o.queryNode,e_.create($(e)))})}set(...e){return new eH({...this.#o,queryNode:eO.cloneWithUpdates(this.#o.queryNode,function(...e){return 2===e.length?[eE.create(B(e[0]),$(e[1]))]:eB(e[0])}(...e))})}returning(e){return new eH({...this.#o,queryNode:eA.cloneWithReturning(this.#o.queryNode,em(e))})}returningAll(e){return new eH({...this.#o,queryNode:eA.cloneWithReturning(this.#o.queryNode,ey(e))})}output(e){return new eH({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,em(e))})}outputAll(e){return new eH({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,ey(e))})}modifyEnd(e){return new eH({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,e.toOperationNode())})}clearReturning(){return new eH({...this.#o,queryNode:eA.cloneWithoutReturning(this.#o.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new eH({...this.#o})}$castTo(){return new eH(this.#o)}$narrowType(){return new eH(this.#o)}$assertType(){return new eH(this.#o)}withPlugin(e){return new eH({...this.#o,executor:this.#o.executor.withPlugin(e)})}toOperationNode(){return this.#o.executor.transformQuery(this.#o.queryNode,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){let e=this.compile(),t=await this.#o.executor.executeQuery(e,this.#o.queryId),{adapter:r}=this.#o.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new eG(t.numAffectedRows??t.numUpdatedOrDeletedRows??BigInt(0),t.numChangedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=eQ){let t=await this.executeTakeFirst();if(void 0===t)throw eP(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#o.executor.stream(t,e,this.#o.queryId))yield*r.rows}async explain(e,t){let r=new eH({...this.#o,queryNode:eA.cloneWithExplain(this.#o.queryNode,e,t)});return await r.execute()}}eh(eH,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");let eX=(0,t.freeze)({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CommonTableExpressionNameNode",table:s.create(e),columns:r?(0,t.freeze)(r.map(w.create)):void 0})}),eY=(0,t.freeze)({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CommonTableExpressionNode",name:e,expression:r}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});class eZ{#o;constructor(e){this.#o=(0,t.freeze)(e)}materialized(){return new eZ({...this.#o,node:eY.cloneWith(this.#o.node,{materialized:!0})})}notMaterialized(){return new eZ({...this.#o,node:eY.cloneWith(this.#o.node,{materialized:!1})})}toOperationNode(){return this.#o.node}}function e0(e,r){var i;let n=r(new tm({executor:tp})).toOperationNode();return(0,t.isFunction)(e)?e((i=n,e=>new eZ({node:eY.create(e1(e),i)}))).toOperationNode():eY.create(e1(e),n)}function e1(e){if(!e.includes("("))return eX.create(e);{let t=e.split(/[\(\)]/),r=t[0],i=t[1].split(",").map(e=>e.trim());return eX.create(r,i)}}eh(eZ,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");let e9=(0,t.freeze)({is:e=>"WithNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"WithNode",expressions:(0,t.freeze)([e]),...r}),cloneWithExpression:(e,r)=>(0,t.freeze)({...e,expressions:(0,t.freeze)([...e.expressions,r])})}),e6=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function e4(){return new e5}class e5{#s;get queryId(){return void 0===this.#s&&(this.#s=function(e){let t="";for(let e=0;e<8;++e)t+=e6[~~(Math.random()*e6.length)];return t}(0)),this.#s}}e.s(["createQueryId",()=>e4],26951);var e8=e.i(36300);let e7=(0,t.freeze)({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),e2={json_agg:!0,to_json:!0};class e3 extends e8.OperationNodeTransformer{#a;#d=new Set;#p=new Set;constructor(e){super(),this.#a=e}transformNodeImpl(e){if(!this.#h(e))return super.transformNodeImpl(e);let t=this.#u(e);for(let e of t)this.#p.add(e);let r=this.#c(e);for(let e of r)this.#d.add(e);let i=super.transformNodeImpl(e);for(let e of r)this.#d.delete(e);for(let e of t)this.#p.delete(e);return i}transformSchemableIdentifier(e){let t=super.transformSchemableIdentifier(e);return t.schema||!this.#d.has(e.identifier.name)?t:{...t,schema:r.create(this.#a)}}transformReferences(e){let t=super.transformReferences(e);return t.table.table.schema?t:{...t,table:s.createWithSchema(this.#a,t.table.table.identifier.name)}}transformAggregateFunction(e){return{...super.transformAggregateFunction({...e,aggregated:[]}),aggregated:this.#l(e,"aggregated")}}transformFunction(e){return{...super.transformFunction({...e,arguments:[]}),arguments:this.#l(e,"arguments")}}#l(e,t){return e2[e.func]?e[t].map(e=>!s.is(e)||e.table.schema?this.transformNode(e):{...e,table:this.transformIdentifier(e.table.identifier)}):this.transformNodeList(e[t])}#h(e){return e.kind in e7}#c(e){let t=new Set;if("name"in e&&e.name&&n.is(e.name)&&this.#f(e.name,t),"from"in e&&e.from)for(let r of e.from.froms)this.#m(r,t);if("into"in e&&e.into&&this.#m(e.into,t),"table"in e&&e.table&&this.#m(e.table,t),"joins"in e&&e.joins)for(let r of e.joins)this.#m(r.table,t);return"using"in e&&e.using&&this.#m(e.using,t),t}#u(e){let t=new Set;return"with"in e&&e.with&&this.#N(e.with,t),t}#m(e,t){let r=s.is(e)?e:o.is(e)&&s.is(e.node)?e.node:null;r&&this.#f(r.table,t)}#f(e,t){let r=e.identifier.name;this.#d.has(r)||this.#p.has(r)||t.add(r)}#N(e,t){for(let r of e.expressions){let e=r.name.table.table.identifier.name;this.#p.has(e)||t.add(e)}}}class te{#y;constructor(e){this.#y=new e3(e)}transformQuery(e){return this.#y.transformNode(e.node)}async transformResult(e){return e.result}}e.s(["WithSchemaPlugin",()=>te],99948);let tt=(0,t.freeze)({is:e=>"MatchedNode"===e.kind,create:(e,r=!1)=>(0,t.freeze)({kind:"MatchedNode",not:e,bySource:r})});function tr(e,t,r){return eI.create(Z([tt.create(!e.isMatched,e.bySource),...t&&t.length>0?[3===t.length&&r?X(t[0],t[1],t[2]):G(t)]:[]],"and",!1))}function ti(e){return(0,t.isString)(e)?W.create([e],[]):a(e)?e.toOperationNode():e}class tn{#w;#g;#v;constructor(){this.#w=new Promise((e,t)=>{this.#v=t,this.#g=e})}get promise(){return this.#w}resolve=e=>{this.#g&&this.#g(e)};reject=e=>{this.#v&&this.#v(e)}}let to=new Set,ts=(0,t.freeze)([]);class ta{#x;constructor(e=ts){this.#x=e}get plugins(){return this.#x}transformQuery(e,t){for(let r of this.#x){let i=r.transformQuery({node:e,queryId:t});if(i.kind===e.kind)e=i;else throw Error(`KyselyPlugin.transformQuery must return a node of the same kind that was given to it. The plugin was given a ${e.kind} but it returned a ${i.kind}`)}return e}async executeQuery(e,t){return await this.provideConnection(async r=>{let i=await r.executeQuery(e),n=await this.#b(i,t);return function(e,t){let{numAffectedRows:r}=e;if((void 0!==r||void 0!==e.numUpdatedOrDeletedRows)&&(void 0===r||void 0===t.numAffectedRows)){var i;i="kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.",to.has(i)||(to.add(i),console.log(i))}}(i,n),n})}async *stream(e,t,r){let i=new tn,n=new tn;this.provideConnection(async e=>(i.resolve(e),await n.promise)).catch(e=>i.reject(e));let o=await i.promise;try{for await(let i of o.streamQuery(e,t))yield await this.#b(i,r)}finally{n.resolve()}}async #b(e,t){for(let r of this.#x)e=await r.transformResult({result:e,queryId:t});return e}}e.s(["QueryExecutorBase",()=>ta],52564);class td extends ta{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(e){return new td([...this.plugins,e])}withPlugins(e){return new td([...this.plugins,...e])}withPluginAtFront(e){return new td([e,...this.plugins])}withoutPlugins(){return new td([])}}let tp=new td;e.s(["NOOP_QUERY_EXECUTOR",0,tp],42856);class th{numChangedRows;constructor(e){this.numChangedRows=e}}class tu{#o;constructor(e){this.#o=(0,t.freeze)(e)}modifyEnd(e){return new tu({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,e.toOperationNode())})}top(e,t){return new tu({...this.#o,queryNode:eA.cloneWithTop(this.#o.queryNode,eJ(e,t))})}using(...e){return new tc({...this.#o,queryNode:eT.cloneWithUsing(this.#o.queryNode,tN("Using",e))})}output(e){return new tu({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,em(e))})}outputAll(e){return new tu({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,ey(e))})}}eh(tu,"don't await MergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class tc{#o;constructor(e){this.#o=(0,t.freeze)(e)}modifyEnd(e){return new tc({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,e.toOperationNode())})}top(e,t){return new tc({...this.#o,queryNode:eA.cloneWithTop(this.#o.queryNode,eJ(e,t))})}whenMatched(){return this.#O([])}whenMatchedAnd(...e){return this.#O(e)}whenMatchedAndRef(e,t,r){return this.#O([e,t,r],!0)}#O(e,t){return new tl({...this.#o,queryNode:eT.cloneWithWhen(this.#o.queryNode,tr({isMatched:!0},e,t))})}whenNotMatched(){return this.#W([])}whenNotMatchedAnd(...e){return this.#W(e)}whenNotMatchedAndRef(e,t,r){return this.#W([e,t,r],!0)}whenNotMatchedBySource(){return this.#W([],!1,!0)}whenNotMatchedBySourceAnd(...e){return this.#W(e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,r){return this.#W([e,t,r],!0,!0)}output(e){return new tc({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,em(e))})}outputAll(e){return new tc({...this.#o,queryNode:eA.cloneWithOutput(this.#o.queryNode,ey(e))})}#W(e,t=!1,r=!1){let i={...this.#o,queryNode:eT.cloneWithWhen(this.#o.queryNode,tr({isMatched:!1,bySource:r},e,t))};return new(r?tl:tf)(i)}$call(e){return e(this)}$if(e,t){return e?t(this):new tc({...this.#o})}toOperationNode(){return this.#o.executor.transformQuery(this.#o.queryNode,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){let e=this.compile(),t=await this.#o.executor.executeQuery(e,this.#o.queryId);return e.query.output&&this.#o.executor.adapter.supportsOutput?t.rows:[new th(t.numAffectedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=eQ){let t=await this.executeTakeFirst();if(void 0===t)throw eP(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}}eh(tc,"don't await WheneableMergeQueryBuilder instances directly. To execute the query you need to call `execute`.");class tl{#o;constructor(e){this.#o=(0,t.freeze)(e)}thenDelete(){return new tc({...this.#o,queryNode:eT.cloneWithThen(this.#o.queryNode,ti("delete"))})}thenDoNothing(){return new tc({...this.#o,queryNode:eT.cloneWithThen(this.#o.queryNode,ti("do nothing"))})}thenUpdate(e){return new tc({...this.#o,queryNode:eT.cloneWithThen(this.#o.queryNode,ti(e(new eH({queryId:this.#o.queryId,executor:tp,queryNode:eO.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate(t=>t.set(...e))}}eh(tl,"don't await MatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class tf{#o;constructor(e){this.#o=(0,t.freeze)(e)}thenDoNothing(){return new tc({...this.#o,queryNode:eT.cloneWithThen(this.#o.queryNode,ti("do nothing"))})}thenInsertValues(e){let[t,r]=ex(e);return new tc({...this.#o,queryNode:eT.cloneWithThen(this.#o.queryNode,ti(eb.cloneWith(eb.createWithoutInto(),{columns:t,values:r})))})}}eh(tf,"don't await NotMatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class tm{#o;constructor(e){this.#o=(0,t.freeze)(e)}selectFrom(e){return new tC({queryId:e4(),executor:this.#o.executor,queryNode:ep.createFrom(tY(e),this.#o.withNode)})}selectNoFrom(e){return new tC({queryId:e4(),executor:this.#o.executor,queryNode:ep.cloneWithSelections(ep.create(this.#o.withNode),em(e))})}insertInto(e){return new e$({queryId:e4(),executor:this.#o.executor,queryNode:eb.create(t1(e),this.#o.withNode)})}replaceInto(e){return new e$({queryId:e4(),executor:this.#o.executor,queryNode:eb.create(t1(e),this.#o.withNode,!0)})}deleteFrom(e){return new eK({queryId:e4(),executor:this.#o.executor,queryNode:eC.create(tY(e),this.#o.withNode)})}updateTable(e){return new eH({queryId:e4(),executor:this.#o.executor,queryNode:eO.create(tZ(e),this.#o.withNode)})}mergeInto(e){return new tu({queryId:e4(),executor:this.#o.executor,queryNode:eT.create(t0(e),this.#o.withNode)})}with(e,t){let r=e0(e,t);return new tm({...this.#o,withNode:this.#o.withNode?e9.cloneWithExpression(this.#o.withNode,r):e9.create(r)})}withRecursive(e,t){let r=e0(e,t);return new tm({...this.#o,withNode:this.#o.withNode?e9.cloneWithExpression(this.#o.withNode,r):e9.create(r,{recursive:!0})})}withPlugin(e){return new tm({...this.#o,executor:this.#o.executor.withPlugin(e)})}withoutPlugins(){return new tm({...this.#o,executor:this.#o.executor.withoutPlugins()})}withSchema(e){return new tm({...this.#o,executor:this.#o.executor.withPluginAtFront(new te(e))})}}function tN(e,t){if(3===t.length){var r,i,n,o;return r=e,i=t[0],n=t[1],o=t[2],c.createWithOn(r,tZ(i),X(n,"=",o))}if(2===t.length)return function(e,t,r){return r(new eu({joinNode:c.create(e,tZ(t))})).toOperationNode()}(e,t[0],t[1]);throw Error("not implemented")}let ty=(0,t.freeze)({is:e=>"OffsetNode"===e.kind,create:e=>(0,t.freeze)({kind:"OffsetNode",offset:e})}),tw=(0,t.freeze)({is:e=>"GroupByItemNode"===e.kind,create:e=>(0,t.freeze)({kind:"GroupByItemNode",groupBy:e})}),tg=(0,t.freeze)({is:e=>"SetOperationNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"SetOperationNode",operator:e,expression:r,all:i})});function tv(e,r,i){return(0,t.isFunction)(r)&&(r=r(tK())),(0,t.isReadonlyArray)(r)||(r=[r]),r.map(t=>tg.create(e,tG(t),i))}e.s(["SetOperationNode",0,tg],39504);class tx{#C;constructor(e){this.#C=e}get expressionType(){}as(e){return new tb(this,e)}or(...e){return new tO(h.create(this.#C,G(e)))}and(...e){return new tW(p.create(this.#C,G(e)))}$castTo(){return new tx(this.#C)}$notNull(){return new tx(this.#C)}toOperationNode(){return this.#C}}class tb{#q;#z;constructor(e,t){this.#q=e,this.#z=t}get expression(){return this.#q}get alias(){return this.#z}toOperationNode(){return o.create(this.#q.toOperationNode(),a(this.#z)?this.#z.toOperationNode():r.create(this.#z))}}class tO{#C;constructor(e){this.#C=e}get expressionType(){}as(e){return new tb(this,e)}or(...e){return new tO(h.create(this.#C,G(e)))}$castTo(){return new tO(this.#C)}toOperationNode(){return K.create(this.#C)}}class tW{#C;constructor(e){this.#C=e}get expressionType(){}as(e){return new tb(this,e)}and(...e){return new tW(p.create(this.#C,G(e)))}$castTo(){return new tW(this.#C)}toOperationNode(){return K.create(this.#C)}}class tC{#o;constructor(e){this.#o=(0,t.freeze)(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new tC({...this.#o,queryNode:eA.cloneWithWhere(this.#o.queryNode,G(e))})}whereRef(e,t,r){return new tC({...this.#o,queryNode:eA.cloneWithWhere(this.#o.queryNode,X(e,t,r))})}having(...e){return new tC({...this.#o,queryNode:ep.cloneWithHaving(this.#o.queryNode,G(e))})}havingRef(e,t,r){return new tC({...this.#o,queryNode:ep.cloneWithHaving(this.#o.queryNode,X(e,t,r))})}select(e){return new tC({...this.#o,queryNode:ep.cloneWithSelections(this.#o.queryNode,em(e))})}distinctOn(e){return new tC({...this.#o,queryNode:ep.cloneWithDistinctOn(this.#o.queryNode,E(e))})}modifyFront(e){return new tC({...this.#o,queryNode:ep.cloneWithFrontModifier(this.#o.queryNode,d.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.createWithExpression(e.toOperationNode()))})}distinct(){return new tC({...this.#o,queryNode:ep.cloneWithFrontModifier(this.#o.queryNode,d.create("Distinct"))})}forUpdate(e){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.create("ForUpdate",e?(0,t.asArray)(e).map(t1):void 0))})}forShare(e){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.create("ForShare",e?(0,t.asArray)(e).map(t1):void 0))})}forKeyShare(e){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.create("ForKeyShare",e?(0,t.asArray)(e).map(t1):void 0))})}forNoKeyUpdate(e){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.create("ForNoKeyUpdate",e?(0,t.asArray)(e).map(t1):void 0))})}skipLocked(){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.create("SkipLocked"))})}noWait(){return new tC({...this.#o,queryNode:eA.cloneWithEndModifier(this.#o.queryNode,d.create("NoWait"))})}selectAll(e){return new tC({...this.#o,queryNode:ep.cloneWithSelections(this.#o.queryNode,ey(e))})}innerJoin(...e){return new tC({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("InnerJoin",e))})}leftJoin(...e){return new tC({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("LeftJoin",e))})}rightJoin(...e){return new tC({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("RightJoin",e))})}fullJoin(...e){return new tC({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("FullJoin",e))})}innerJoinLateral(...e){return new tC({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("LateralInnerJoin",e))})}leftJoinLateral(...e){return new tC({...this.#o,queryNode:eA.cloneWithJoin(this.#o.queryNode,tN("LateralLeftJoin",e))})}orderBy(...e){return new tC({...this.#o,queryNode:ep.cloneWithOrderByItems(this.#o.queryNode,q(e))})}groupBy(e){var r;return new tC({...this.#o,queryNode:ep.cloneWithGroupByItems(this.#o.queryNode,(r=e,E(r=(0,t.isFunction)(r)?r(tK()):r).map(tw.create)))})}limit(e){return new tC({...this.#o,queryNode:ep.cloneWithLimit(this.#o.queryNode,e_.create($(e)))})}offset(e){return new tC({...this.#o,queryNode:ep.cloneWithOffset(this.#o.queryNode,ty.create($(e)))})}fetch(e,r="only"){return new tC({...this.#o,queryNode:ep.cloneWithFetch(this.#o.queryNode,function(e,r){var i;let n,o;if(!(0,t.isNumber)(e)&&!(0,t.isBigInt)(e))throw Error(`Invalid fetch row count: ${e}`);if("only"!==(i=r)&&"with ties"!==i)throw Error(`Invalid fetch modifier: ${r}`);return n=e,o=r,{kind:"FetchNode",rowCount:V.create(n),modifier:o}}(e,r))})}top(e,t){return new tC({...this.#o,queryNode:eA.cloneWithTop(this.#o.queryNode,eJ(e,t))})}union(e){return new tC({...this.#o,queryNode:ep.cloneWithSetOperations(this.#o.queryNode,tv("union",e,!1))})}unionAll(e){return new tC({...this.#o,queryNode:ep.cloneWithSetOperations(this.#o.queryNode,tv("union",e,!0))})}intersect(e){return new tC({...this.#o,queryNode:ep.cloneWithSetOperations(this.#o.queryNode,tv("intersect",e,!1))})}intersectAll(e){return new tC({...this.#o,queryNode:ep.cloneWithSetOperations(this.#o.queryNode,tv("intersect",e,!0))})}except(e){return new tC({...this.#o,queryNode:ep.cloneWithSetOperations(this.#o.queryNode,tv("except",e,!1))})}exceptAll(e){return new tC({...this.#o,queryNode:ep.cloneWithSetOperations(this.#o.queryNode,tv("except",e,!0))})}as(e){return new tq(this,e)}clearSelect(){return new tC({...this.#o,queryNode:ep.cloneWithoutSelections(this.#o.queryNode)})}clearWhere(){return new tC({...this.#o,queryNode:eA.cloneWithoutWhere(this.#o.queryNode)})}clearLimit(){return new tC({...this.#o,queryNode:ep.cloneWithoutLimit(this.#o.queryNode)})}clearOffset(){return new tC({...this.#o,queryNode:ep.cloneWithoutOffset(this.#o.queryNode)})}clearOrderBy(){return new tC({...this.#o,queryNode:ep.cloneWithoutOrderBy(this.#o.queryNode)})}clearGroupBy(){return new tC({...this.#o,queryNode:ep.cloneWithoutGroupBy(this.#o.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new tC({...this.#o})}$castTo(){return new tC(this.#o)}$narrowType(){return new tC(this.#o)}$assertType(){return new tC(this.#o)}$asTuple(){return new tx(this.toOperationNode())}withPlugin(e){return new tC({...this.#o,executor:this.#o.executor.withPlugin(e)})}toOperationNode(){return this.#o.executor.transformQuery(this.#o.queryNode,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){let e=this.compile();return(await this.#o.executor.executeQuery(e,this.#o.queryId)).rows}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=eQ){let t=await this.executeTakeFirst();if(void 0===t)throw eP(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#o.executor.stream(t,e,this.#o.queryId))yield*r.rows}async explain(e,t){let r=new tC({...this.#o,queryNode:eA.cloneWithExplain(this.#o.queryNode,e,t)});return await r.execute()}}eh(tC,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class tq{#k;#z;constructor(e,t){this.#k=e,this.#z=t}get expression(){return this.#k}get alias(){return this.#z}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return o.create(this.#k.toOperationNode(),r.create(this.#z))}}eh(tq,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query."),e.s(["createFunctionModule",()=>tS],25176);let tz=(0,t.freeze)({is:e=>"AggregateFunctionNode"===e.kind,create:(e,r=[])=>(0,t.freeze)({kind:"AggregateFunctionNode",func:e,aggregated:r}),cloneWithDistinct:e=>(0,t.freeze)({...e,distinct:!0}),cloneWithOrderBy:(e,r)=>(0,t.freeze)({...e,orderBy:e.orderBy?ei.cloneWithItems(e.orderBy,r):ei.create(r)}),cloneWithFilter:(e,r)=>(0,t.freeze)({...e,filter:e.filter?eq.cloneWithOperation(e.filter,"And",r):eq.create(r)}),cloneWithOrFilter:(e,r)=>(0,t.freeze)({...e,filter:e.filter?eq.cloneWithOperation(e.filter,"Or",r):eq.create(r)}),cloneWithOver:(e,r)=>(0,t.freeze)({...e,over:r})}),tk=(0,t.freeze)({is:e=>"FunctionNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"FunctionNode",func:e,arguments:r})});class tI{#o;constructor(e){this.#o=(0,t.freeze)(e)}get expressionType(){}as(e){return new tT(this,e)}distinct(){return new tI({...this.#o,aggregateFunctionNode:tz.cloneWithDistinct(this.#o.aggregateFunctionNode)})}orderBy(e,t){return new tI({...this.#o,aggregateFunctionNode:tz.cloneWithOrderBy(this.#o.aggregateFunctionNode,q([e,t]))})}filterWhere(...e){return new tI({...this.#o,aggregateFunctionNode:tz.cloneWithFilter(this.#o.aggregateFunctionNode,G(e))})}filterWhereRef(e,t,r){return new tI({...this.#o,aggregateFunctionNode:tz.cloneWithFilter(this.#o.aggregateFunctionNode,X(e,t,r))})}over(e){let t=new el({overNode:eo.create()});return new tI({...this.#o,aggregateFunctionNode:tz.cloneWithOver(this.#o.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new tI(this.#o)}$notNull(){return new tI(this.#o)}toOperationNode(){return this.#o.aggregateFunctionNode}}eh(tI,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class tT{#I;#z;constructor(e,t){this.#I=e,this.#z=t}get expression(){return this.#I}get alias(){return this.#z}toOperationNode(){return o.create(this.#I.toOperationNode(),r.create(this.#z))}}function tS(){let e=(e,t)=>new tx(tk.create(e,E(t??[]))),r=(e,t)=>new tI({aggregateFunctionNode:tz.create(e,t?E(t):void 0)});return Object.assign(e,{agg:r,avg:e=>r("avg",[e]),coalesce:(...t)=>e("coalesce",t),count:e=>r("count",[e]),countAll:e=>new tI({aggregateFunctionNode:tz.create("count",ey(e))}),max:e=>r("max",[e]),min:e=>r("min",[e]),sum:e=>r("sum",[e]),any:t=>e("any",[t]),jsonAgg:e=>new tI({aggregateFunctionNode:tz.create("json_agg",[(0,t.isString)(e)?t1(e):e.toOperationNode()])}),toJson:e=>new tx(tk.create("to_json",[(0,t.isString)(e)?t1(e):e.toOperationNode()]))})}let tA=(0,t.freeze)({is:e=>"UnaryOperationNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"UnaryOperationNode",operator:e,operand:r})});e.s(["CaseBuilder",()=>tB],91658);let tE=(0,t.freeze)({is:e=>"CaseNode"===e.kind,create:e=>(0,t.freeze)({kind:"CaseNode",value:e}),cloneWithWhen:(e,r)=>(0,t.freeze)({...e,when:(0,t.freeze)(e.when?[...e.when,r]:[r])}),cloneWithThen:(e,r)=>(0,t.freeze)({...e,when:e.when?(0,t.freeze)([...e.when.slice(0,-1),eI.cloneWithResult(e.when[e.when.length-1],r)]):void 0}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["CaseNode",0,tE],2757);class tB{#o;constructor(e){this.#o=(0,t.freeze)(e)}when(...e){return new tD({...this.#o,node:tE.cloneWithWhen(this.#o.node,eI.create(G(e)))})}}class tD{#o;constructor(e){this.#o=(0,t.freeze)(e)}then(e){return new tL({...this.#o,node:tE.cloneWithThen(this.#o.node,j(e)?_(e):$(e))})}}class tL{#o;constructor(e){this.#o=(0,t.freeze)(e)}when(...e){return new tD({...this.#o,node:tE.cloneWithWhen(this.#o.node,eI.create(G(e)))})}else(e){return new tQ({...this.#o,node:tE.cloneWith(this.#o.node,{else:j(e)?_(e):$(e)})})}end(){return new tx(tE.cloneWith(this.#o.node,{isStatement:!1}))}endCase(){return new tx(tE.cloneWith(this.#o.node,{isStatement:!0}))}}class tQ{#o;constructor(e){this.#o=(0,t.freeze)(e)}end(){return new tx(tE.cloneWith(this.#o.node,{isStatement:!1}))}endCase(){return new tx(tE.cloneWith(this.#o.node,{isStatement:!0}))}}let tP=(0,t.freeze)({is:e=>"JSONPathLegNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"JSONPathLegNode",type:e,value:r})});class tR{#C;constructor(e){this.#C=e}at(e){return this.#T("ArrayLocation",e)}key(e){return this.#T("Member",e)}#T(e,t){return new tM(I.is(this.#C)?I.cloneWithTraversal(this.#C,S.is(this.#C.traversal)?S.cloneWithLeg(this.#C.traversal,tP.create(e,t)):T.cloneWithValue(this.#C.traversal,V.createImmediate(t))):S.cloneWithLeg(this.#C,tP.create(e,t)))}}class tM extends tR{#C;constructor(e){super(e),this.#C=e}get expressionType(){}as(e){return new tF(this,e)}$castTo(){return new tM(this.#C)}$notNull(){return new tM(this.#C)}toOperationNode(){return this.#C}}class tF{#S;#z;constructor(e,t){this.#S=e,this.#z=t}get expression(){return this.#S}get alias(){return this.#z}toOperationNode(){return o.create(this.#S.toOperationNode(),a(this.#z)?this.#z.toOperationNode():r.create(this.#z))}}let tU=(0,t.freeze)({is:e=>"TupleNode"===e.kind,create:e=>(0,t.freeze)({kind:"TupleNode",values:(0,t.freeze)(e)})}),tV=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],tJ=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],t$=(0,t.freeze)({is:e=>"DataTypeNode"===e.kind,create:e=>(0,t.freeze)({kind:"DataTypeNode",dataType:e})});function tj(e){if(a(e))return e.toOperationNode();if(tV.includes(e)||tJ.some(t=>t.test(e)))return t$.create(e);throw Error(`invalid column data type ${JSON.stringify(e)}`)}e.s(["parseDataTypeExpression",()=>tj],75670);let t_=(0,t.freeze)({is:e=>"CastNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CastNode",expression:e,dataType:r})});function tK(e=tp){function r(e,t){return new tx(tA.create(N.create(e),B(t)))}let i=Object.assign(function(e,t,r){return new tx(H(e,t,r))},{fn:void 0,eb:void 0,selectFrom:t=>new tC({queryId:e4(),executor:e,queryNode:ep.createFrom(tY(t))}),case:e=>new tB({node:tE.create((0,t.isUndefined)(e)?void 0:B(e))}),ref:(e,r)=>(0,t.isUndefined)(r)?new tx(L(e)):new tR(D(e,r)),jsonPath:()=>new tR(S.create()),table:e=>new tx(t1(e)),val:e=>new tx($(e)),refTuple:(...e)=>new tx(tU.create(e.map(B))),tuple:(...e)=>new tx(tU.create(e.map($))),lit:e=>new tx(_(e)),unary:r,not:e=>r("not",e),exists:e=>r("exists",e),neg:e=>r("-",e),between:(e,t,r)=>new tx(l.create(B(e),N.create("between"),p.create($(t),$(r)))),betweenSymmetric:(e,t,r)=>new tx(l.create(B(e),N.create("between symmetric"),p.create($(t),$(r)))),and:e=>new tx((0,t.isReadonlyArray)(e)?Z(e,"and"):Y(e,"and")),or:e=>new tx((0,t.isReadonlyArray)(e)?Z(e,"or"):Y(e,"or")),parens(...e){let t=G(e);return new tx(K.is(t)?t:K.create(t))},cast:(e,t)=>new tx(t_.create(B(e),tj(t))),withSchema:t=>tK(e.withPluginAtFront(new te(t)))});return i.fn=tS(),i.eb=i,i}function tG(e){if(a(e))return e.toOperationNode();if((0,t.isFunction)(e))return e(tK()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(e)}`)}function tH(e){if(a(e))return e.toOperationNode();if((0,t.isFunction)(e))return e(tK()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function tX(e){return(0,t.isObject)(e)&&"expressionType"in e&&a(e)||(0,t.isObject)(e)&&"expression"in e&&(0,t.isString)(e.alias)&&a(e)||(0,t.isFunction)(e)}function tY(e){return(0,t.isReadonlyArray)(e)?e.map(e=>tZ(e)):[tZ(e)]}function tZ(e){return(0,t.isString)(e)?t0(e):tH(e)}function t0(e){let t=" as ";if(!e.includes(t))return t1(e);{let[i,n]=e.split(t).map(t9);return o.create(t1(i),r.create(n))}}function t1(e){if(!e.includes("."))return s.create(e);{let[t,r]=e.split(".").map(t9);return s.createWithSchema(t,r)}}function t9(e){return e.trim()}let t6=(0,t.freeze)({is:e=>"CreateViewNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateViewNode",name:n.create(e)}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["CreateViewNode",0,t6],78655)},87679,e=>{"use strict";var t=e.i(59094);let r=(0,t.freeze)({is:e=>"AlterTableNode"===e.kind,create:e=>(0,t.freeze)({kind:"AlterTableNode",table:e}),cloneWithTableProps:(e,r)=>(0,t.freeze)({...e,...r}),cloneWithColumnAlteration:(e,r)=>(0,t.freeze)({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,r]:[r]})});var i=e.i(61761);let n=(0,t.freeze)({is:e=>"CreateIndexNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateIndexNode",name:i.IdentifierNode.create(e)}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r}),cloneWithColumns:(e,r)=>(0,t.freeze)({...e,columns:[...e.columns||[],...r]})}),o=(0,t.freeze)({is:e=>"CreateSchemaNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CreateSchemaNode",schema:i.IdentifierNode.create(e),...r}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});var s=e.i(69972),a=e.i(66586);let d=(0,t.freeze)({is:e=>"DropIndexNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"DropIndexNode",name:a.SchemableIdentifierNode.create(e),...r}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})}),p=(0,t.freeze)({is:e=>"DropSchemaNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"DropSchemaNode",schema:i.IdentifierNode.create(e),...r}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})}),h=(0,t.freeze)({is:e=>"DropTableNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"DropTableNode",table:e,...r}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});var u=e.i(92465);let c=(0,t.freeze)({is:e=>"AddColumnNode"===e.kind,create:e=>(0,t.freeze)({kind:"AddColumnNode",column:e})});var l=e.i(81196);let f=(0,t.freeze)({is:e=>"ColumnDefinitionNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ColumnDefinitionNode",column:l.ColumnNode.create(e),dataType:r}),cloneWithFrontModifier:(e,r)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,r]):[r]}),cloneWithEndModifier:(e,r)=>(0,t.freeze)({...e,endModifiers:e.endModifiers?(0,t.freeze)([...e.endModifiers,r]):[r]}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})}),m=(0,t.freeze)({is:e=>"DropColumnNode"===e.kind,create:e=>(0,t.freeze)({kind:"DropColumnNode",column:l.ColumnNode.create(e)})}),N=(0,t.freeze)({is:e=>"RenameColumnNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"RenameColumnNode",column:l.ColumnNode.create(e),renameTo:l.ColumnNode.create(r)})});var y=e.i(48490);let w=(0,t.freeze)({is:e=>"CheckConstraintNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CheckConstraintNode",expression:e,name:r?i.IdentifierNode.create(r):void 0})}),g=["no action","restrict","cascade","set null","set default"],v=(0,t.freeze)({is:e=>"ReferencesNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ReferencesNode",table:e,columns:(0,t.freeze)([...r])}),cloneWithOnDelete:(e,r)=>(0,t.freeze)({...e,onDelete:r}),cloneWithOnUpdate:(e,r)=>(0,t.freeze)({...e,onUpdate:r})});var x=e.i(44550),b=e.i(58390),O=e.i(44473),W=e.i(4196);function C(e){return(0,O.isOperationNodeSource)(e)?e.toOperationNode():W.ValueNode.createImmediate(e)}let q=(0,t.freeze)({is:e=>"GeneratedNode"===e.kind,create:e=>(0,t.freeze)({kind:"GeneratedNode",...e}),createWithExpression:e=>(0,t.freeze)({kind:"GeneratedNode",always:!0,expression:e}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})}),z=(0,t.freeze)({is:e=>"DefaultValueNode"===e.kind,create:e=>(0,t.freeze)({kind:"DefaultValueNode",defaultValue:e})});function k(e){if(g.includes(e))return e;throw Error(`invalid OnModifyForeignAction ${e}`)}class I{#C;constructor(e){this.#C=e}autoIncrement(){return new I(f.cloneWith(this.#C,{autoIncrement:!0}))}identity(){return new I(f.cloneWith(this.#C,{identity:!0}))}primaryKey(){return new I(f.cloneWith(this.#C,{primaryKey:!0}))}references(e){let t=(0,b.parseStringReference)(e);if(!t.table||x.SelectAllNode.is(t.column))throw Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new I(f.cloneWith(this.#C,{references:v.create(t.table,[t.column])}))}onDelete(e){if(!this.#C.references)throw Error("on delete constraint can only be added for foreign keys");return new I(f.cloneWith(this.#C,{references:v.cloneWithOnDelete(this.#C.references,k(e))}))}onUpdate(e){if(!this.#C.references)throw Error("on update constraint can only be added for foreign keys");return new I(f.cloneWith(this.#C,{references:v.cloneWithOnUpdate(this.#C.references,k(e))}))}unique(){return new I(f.cloneWith(this.#C,{unique:!0}))}notNull(){return new I(f.cloneWith(this.#C,{notNull:!0}))}unsigned(){return new I(f.cloneWith(this.#C,{unsigned:!0}))}defaultTo(e){return new I(f.cloneWith(this.#C,{defaultTo:z.create(C(e))}))}check(e){return new I(f.cloneWith(this.#C,{check:w.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new I(f.cloneWith(this.#C,{generated:q.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new I(f.cloneWith(this.#C,{generated:q.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new I(f.cloneWith(this.#C,{generated:q.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#C.generated)throw Error("stored() can only be called after generatedAlwaysAs");return new I(f.cloneWith(this.#C,{generated:q.cloneWith(this.#C.generated,{stored:!0})}))}modifyFront(e){return new I(f.cloneWithFrontModifier(this.#C,e.toOperationNode()))}nullsNotDistinct(){return new I(f.cloneWith(this.#C,{nullsNotDistinct:!0}))}ifNotExists(){return new I(f.cloneWith(this.#C,{ifNotExists:!0}))}modifyEnd(e){return new I(f.cloneWithEndModifier(this.#C,e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return this.#C}}(0,y.preventAwait)(I,"don't await ColumnDefinitionBuilder instances directly.");let T=(0,t.freeze)({is:e=>"ModifyColumnNode"===e.kind,create:e=>(0,t.freeze)({kind:"ModifyColumnNode",column:e})});var S=e.i(75670);let A=(0,t.freeze)({is:e=>"ForeignKeyConstraintNode"===e.kind,create:(e,r,n,o)=>(0,t.freeze)({kind:"ForeignKeyConstraintNode",columns:e,references:v.create(r,n),name:o?i.IdentifierNode.create(o):void 0}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});class E{#C;constructor(e){this.#C=e}onDelete(e){return new E(A.cloneWith(this.#C,{onDelete:k(e)}))}onUpdate(e){return new E(A.cloneWith(this.#C,{onUpdate:k(e)}))}$call(e){return e(this)}toOperationNode(){return this.#C}}(0,y.preventAwait)(E,"don't await ForeignKeyConstraintBuilder instances directly.");let B=(0,t.freeze)({is:e=>"AddConstraintNode"===e.kind,create:e=>(0,t.freeze)({kind:"AddConstraintNode",constraint:e})}),D=(0,t.freeze)({is:e=>"UniqueConstraintNode"===e.kind,create:(e,r,n)=>(0,t.freeze)({kind:"UniqueConstraintNode",columns:(0,t.freeze)(e.map(l.ColumnNode.create)),name:r?i.IdentifierNode.create(r):void 0,nullsNotDistinct:n}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})}),L=(0,t.freeze)({is:e=>"DropConstraintNode"===e.kind,create:e=>(0,t.freeze)({kind:"DropConstraintNode",constraintName:i.IdentifierNode.create(e)}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})}),Q=(0,t.freeze)({is:e=>"AlterColumnNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"AlterColumnNode",column:l.ColumnNode.create(e),[r]:i})});class P{#A;constructor(e){this.#A=e}setDataType(e){return new R(Q.create(this.#A,"dataType",(0,S.parseDataTypeExpression)(e)))}setDefault(e){return new R(Q.create(this.#A,"setDefault",C(e)))}dropDefault(){return new R(Q.create(this.#A,"dropDefault",!0))}setNotNull(){return new R(Q.create(this.#A,"setNotNull",!0))}dropNotNull(){return new R(Q.create(this.#A,"dropNotNull",!0))}$call(e){return e(this)}}(0,y.preventAwait)(P,"don't await AlterColumnBuilder instances");class R{#E;constructor(e){this.#E=e}toOperationNode(){return this.#E}}(0,y.preventAwait)(R,"don't await AlteredColumnBuilder instances");class M{#o;constructor(e){this.#o=(0,t.freeze)(e)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(M,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");class F{#o;constructor(e){this.#o=(0,t.freeze)(e)}onDelete(e){return new F({...this.#o,constraintBuilder:this.#o.constraintBuilder.onDelete(e)})}onUpdate(e){return new F({...this.#o,constraintBuilder:this.#o.constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(r.cloneWithTableProps(this.#o.node,{addConstraint:B.create(this.#o.constraintBuilder.toOperationNode())}),this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(F,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");class U{#o;constructor(e){this.#o=(0,t.freeze)(e)}ifExists(){return new U({...this.#o,node:r.cloneWithTableProps(this.#o.node,{dropConstraint:L.cloneWith(this.#o.node.dropConstraint,{ifExists:!0})})})}cascade(){return new U({...this.#o,node:r.cloneWithTableProps(this.#o.node,{dropConstraint:L.cloneWith(this.#o.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new U({...this.#o,node:r.cloneWithTableProps(this.#o.node,{dropConstraint:L.cloneWith(this.#o.node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(U,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");let V=(0,t.freeze)({is:e=>"PrimaryKeyConstraintNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"PrimaryKeyConstraintNode",columns:(0,t.freeze)(e.map(l.ColumnNode.create)),name:r?i.IdentifierNode.create(r):void 0})}),J=(0,t.freeze)({is:e=>"AddIndexNode"===e.kind,create:e=>(0,t.freeze)({kind:"AddIndexNode",name:i.IdentifierNode.create(e)}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r}),cloneWithColumns:(e,r)=>(0,t.freeze)({...e,columns:[...e.columns||[],...r]})});var $=e.i(1765);class j{#o;constructor(e){this.#o=(0,t.freeze)(e)}unique(){return new j({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addIndex:J.cloneWith(this.#o.node.addIndex,{unique:!0})})})}column(e){return new j({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addIndex:J.cloneWithColumns(this.#o.node.addIndex,[(0,b.parseOrderedColumnName)(e)])})})}columns(e){return new j({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addIndex:J.cloneWithColumns(this.#o.node.addIndex,e.map(b.parseOrderedColumnName))})})}expression(e){return new j({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addIndex:J.cloneWithColumns(this.#o.node.addIndex,[e.toOperationNode()])})})}using(e){return new j({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addIndex:J.cloneWith(this.#o.node.addIndex,{using:$.RawNode.createWithSql(e)})})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(j,"don't await AlterTableAddIndexBuilder instances directly. To execute the query you need to call `execute`");class _{#C;constructor(e){this.#C=e}toOperationNode(){return this.#C}nullsNotDistinct(){return new _(D.cloneWith(this.#C,{nullsNotDistinct:!0}))}}(0,y.preventAwait)(_,"don't await UniqueConstraintNodeBuilder instances directly.");class K{#o;constructor(e){this.#o=(0,t.freeze)(e)}renameTo(e){return new M({...this.#o,node:r.cloneWithTableProps(this.#o.node,{renameTo:(0,u.parseTable)(e)})})}setSchema(e){return new M({...this.#o,node:r.cloneWithTableProps(this.#o.node,{setSchema:i.IdentifierNode.create(e)})})}alterColumn(e,t){let i=t(new P(e));return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,i.toOperationNode())})}dropColumn(e){return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,m.create(e))})}renameColumn(e,t){return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,N.create(e,t))})}addColumn(e,i,n=t.noop){let o=n(new I(f.create(e,(0,S.parseDataTypeExpression)(i))));return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,c.create(o.toOperationNode()))})}modifyColumn(e,i,n=t.noop){let o=n(new I(f.create(e,(0,S.parseDataTypeExpression)(i))));return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,T.create(o.toOperationNode()))})}addUniqueConstraint(e,i,n=t.noop){let o=n(new _(D.create(i,e)));return new M({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addConstraint:B.create(o.toOperationNode())})})}addCheckConstraint(e,t){return new M({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addConstraint:B.create(w.create(t.toOperationNode(),e))})})}addForeignKeyConstraint(e,t,r,i){return new F({...this.#o,constraintBuilder:new E(A.create(t.map(l.ColumnNode.create),(0,u.parseTable)(r),i.map(l.ColumnNode.create),e))})}addPrimaryKeyConstraint(e,t){return new M({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addConstraint:B.create(V.create(t,e))})})}dropConstraint(e){return new U({...this.#o,node:r.cloneWithTableProps(this.#o.node,{dropConstraint:L.create(e)})})}addIndex(e){return new j({...this.#o,node:r.cloneWithTableProps(this.#o.node,{addIndex:J.create(e)})})}dropIndex(e){return new M({...this.#o,node:r.cloneWithTableProps(this.#o.node,{dropIndex:d.create(e)})})}$call(e){return e(this)}}(0,y.preventAwait)(K,"don't await AlterTableBuilder instances");class G{#o;constructor(e){this.#o=(0,t.freeze)(e)}alterColumn(e,t){let i=t(new P(e));return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,i.toOperationNode())})}dropColumn(e){return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,m.create(e))})}renameColumn(e,t){return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,N.create(e,t))})}addColumn(e,i,n=t.noop){let o=n(new I(f.create(e,(0,S.parseDataTypeExpression)(i))));return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,c.create(o.toOperationNode()))})}modifyColumn(e,i,n=t.noop){let o=n(new I(f.create(e,(0,S.parseDataTypeExpression)(i))));return new G({...this.#o,node:r.cloneWithColumnAlteration(this.#o.node,T.create(o.toOperationNode()))})}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(G,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");var H=e.i(54996),X=e.i(92868),Y=e.i(36300);class Z extends Y.OperationNodeTransformer{transformValue(e){return{...super.transformValue(e),immediate:!0}}}class ee{#o;constructor(e){this.#o=(0,t.freeze)(e)}ifNotExists(){return new ee({...this.#o,node:n.cloneWith(this.#o.node,{ifNotExists:!0})})}unique(){return new ee({...this.#o,node:n.cloneWith(this.#o.node,{unique:!0})})}nullsNotDistinct(){return new ee({...this.#o,node:n.cloneWith(this.#o.node,{nullsNotDistinct:!0})})}on(e){return new ee({...this.#o,node:n.cloneWith(this.#o.node,{table:(0,u.parseTable)(e)})})}column(e){return new ee({...this.#o,node:n.cloneWithColumns(this.#o.node,[(0,b.parseOrderedColumnName)(e)])})}columns(e){return new ee({...this.#o,node:n.cloneWithColumns(this.#o.node,e.map(b.parseOrderedColumnName))})}expression(e){return new ee({...this.#o,node:n.cloneWithColumns(this.#o.node,[e.toOperationNode()])})}using(e){return new ee({...this.#o,node:n.cloneWith(this.#o.node,{using:$.RawNode.createWithSql(e)})})}where(...e){let t=new Z;return new ee({...this.#o,node:X.QueryNode.cloneWithWhere(this.#o.node,t.transformNode((0,H.parseValueBinaryOperationOrExpression)(e)))})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(ee,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");class et{#o;constructor(e){this.#o=(0,t.freeze)(e)}ifNotExists(){return new et({...this.#o,node:o.cloneWith(this.#o.node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(et,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");var er=e.i(69918);class ei{#o;constructor(e){this.#o=(0,t.freeze)(e)}temporary(){return new ei({...this.#o,node:s.CreateTableNode.cloneWith(this.#o.node,{temporary:!0})})}onCommit(e){return new ei({...this.#o,node:s.CreateTableNode.cloneWith(this.#o.node,{onCommit:function(e){if(s.ON_COMMIT_ACTIONS.includes(e))return e;throw Error(`invalid OnCommitAction ${e}`)}(e)})})}ifNotExists(){return new ei({...this.#o,node:s.CreateTableNode.cloneWith(this.#o.node,{ifNotExists:!0})})}addColumn(e,r,i=t.noop){let n=i(new I(f.create(e,(0,S.parseDataTypeExpression)(r))));return new ei({...this.#o,node:s.CreateTableNode.cloneWithColumn(this.#o.node,n.toOperationNode())})}addPrimaryKeyConstraint(e,t){return new ei({...this.#o,node:s.CreateTableNode.cloneWithConstraint(this.#o.node,V.create(t,e))})}addUniqueConstraint(e,r,i=t.noop){let n=i(new _(D.create(r,e)));return new ei({...this.#o,node:s.CreateTableNode.cloneWithConstraint(this.#o.node,n.toOperationNode())})}addCheckConstraint(e,t){return new ei({...this.#o,node:s.CreateTableNode.cloneWithConstraint(this.#o.node,w.create(t.toOperationNode(),e))})}addForeignKeyConstraint(e,r,i,n,o=t.noop){let a=o(new E(A.create(r.map(l.ColumnNode.create),(0,u.parseTable)(i),n.map(l.ColumnNode.create),e)));return new ei({...this.#o,node:s.CreateTableNode.cloneWithConstraint(this.#o.node,a.toOperationNode())})}modifyFront(e){return new ei({...this.#o,node:s.CreateTableNode.cloneWithFrontModifier(this.#o.node,e.toOperationNode())})}modifyEnd(e){return new ei({...this.#o,node:s.CreateTableNode.cloneWithEndModifier(this.#o.node,e.toOperationNode())})}as(e){return new ei({...this.#o,node:s.CreateTableNode.cloneWith(this.#o.node,{selectQuery:(0,er.parseExpression)(e)})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(ei,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");class en{#o;constructor(e){this.#o=(0,t.freeze)(e)}on(e){return new en({...this.#o,node:d.cloneWith(this.#o.node,{table:(0,u.parseTable)(e)})})}ifExists(){return new en({...this.#o,node:d.cloneWith(this.#o.node,{ifExists:!0})})}cascade(){return new en({...this.#o,node:d.cloneWith(this.#o.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(en,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");class eo{#o;constructor(e){this.#o=(0,t.freeze)(e)}ifExists(){return new eo({...this.#o,node:p.cloneWith(this.#o.node,{ifExists:!0})})}cascade(){return new eo({...this.#o,node:p.cloneWith(this.#o.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(eo,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");class es{#o;constructor(e){this.#o=(0,t.freeze)(e)}ifExists(){return new es({...this.#o,node:h.cloneWith(this.#o.node,{ifExists:!0})})}cascade(){return new es({...this.#o,node:h.cloneWith(this.#o.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(es,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");var ea=e.i(26951),ed=e.i(99948),ep=e.i(78655);class eh{#y=new Z;transformQuery(e){return this.#y.transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}class eu{#o;constructor(e){this.#o=(0,t.freeze)(e)}temporary(){return new eu({...this.#o,node:ep.CreateViewNode.cloneWith(this.#o.node,{temporary:!0})})}materialized(){return new eu({...this.#o,node:ep.CreateViewNode.cloneWith(this.#o.node,{materialized:!0})})}ifNotExists(){return new eu({...this.#o,node:ep.CreateViewNode.cloneWith(this.#o.node,{ifNotExists:!0})})}orReplace(){return new eu({...this.#o,node:ep.CreateViewNode.cloneWith(this.#o.node,{orReplace:!0})})}columns(e){return new eu({...this.#o,node:ep.CreateViewNode.cloneWith(this.#o.node,{columns:e.map(b.parseColumnName)})})}as(e){let t=e.withPlugin(new eh).toOperationNode();return new eu({...this.#o,node:ep.CreateViewNode.cloneWith(this.#o.node,{as:t})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(eu,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");let ec=(0,t.freeze)({is:e=>"DropViewNode"===e.kind,create:e=>(0,t.freeze)({kind:"DropViewNode",name:a.SchemableIdentifierNode.create(e)}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});class el{#o;constructor(e){this.#o=(0,t.freeze)(e)}materialized(){return new el({...this.#o,node:ec.cloneWith(this.#o.node,{materialized:!0})})}ifExists(){return new el({...this.#o,node:ec.cloneWith(this.#o.node,{ifExists:!0})})}cascade(){return new el({...this.#o,node:ec.cloneWith(this.#o.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(el,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");var ef=e.i(93846);let em=(0,t.freeze)({is:e=>"CreateTypeNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateTypeNode",name:e}),cloneWithEnum:(e,r)=>(0,t.freeze)({...e,enum:ef.ValueListNode.create(r.map(e=>W.ValueNode.createImmediate(e)))})});class eN{#o;constructor(e){this.#o=(0,t.freeze)(e)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}asEnum(e){return new eN({...this.#o,node:em.cloneWithEnum(this.#o.node,e)})}$call(e){return e(this)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}(0,y.preventAwait)(eN,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");let ey=(0,t.freeze)({is:e=>"DropTypeNode"===e.kind,create:e=>(0,t.freeze)({kind:"DropTypeNode",name:e}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});class ew{#o;constructor(e){this.#o=(0,t.freeze)(e)}ifExists(){return new ew({...this.#o,node:ey.cloneWith(this.#o.node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#o.executor.transformQuery(this.#o.node,this.#o.queryId)}compile(){return this.#o.executor.compileQuery(this.toOperationNode(),this.#o.queryId)}async execute(){await this.#o.executor.executeQuery(this.compile(),this.#o.queryId)}}function eg(e){if(!e.includes("."))return a.SchemableIdentifierNode.create(e);{let t=e.split(".").map(ev);if(2===t.length)return a.SchemableIdentifierNode.createWithSchema(t[0],t[1]);throw Error(`invalid schemable identifier ${e}`)}}function ev(e){return e.trim()}(0,y.preventAwait)(ew,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");class ex{#B;constructor(e){this.#B=e}createTable(e){return new ei({queryId:(0,ea.createQueryId)(),executor:this.#B,node:s.CreateTableNode.create((0,u.parseTable)(e))})}dropTable(e){return new es({queryId:(0,ea.createQueryId)(),executor:this.#B,node:h.create((0,u.parseTable)(e))})}createIndex(e){return new ee({queryId:(0,ea.createQueryId)(),executor:this.#B,node:n.create(e)})}dropIndex(e){return new en({queryId:(0,ea.createQueryId)(),executor:this.#B,node:d.create(e)})}createSchema(e){return new et({queryId:(0,ea.createQueryId)(),executor:this.#B,node:o.create(e)})}dropSchema(e){return new eo({queryId:(0,ea.createQueryId)(),executor:this.#B,node:p.create(e)})}alterTable(e){return new K({queryId:(0,ea.createQueryId)(),executor:this.#B,node:r.create((0,u.parseTable)(e))})}createView(e){return new eu({queryId:(0,ea.createQueryId)(),executor:this.#B,node:ep.CreateViewNode.create(e)})}dropView(e){return new el({queryId:(0,ea.createQueryId)(),executor:this.#B,node:ec.create(e)})}createType(e){return new eN({queryId:(0,ea.createQueryId)(),executor:this.#B,node:em.create(eg(e))})}dropType(e){return new ew({queryId:(0,ea.createQueryId)(),executor:this.#B,node:ey.create(eg(e))})}withPlugin(e){return new ex(this.#B.withPlugin(e))}withoutPlugins(){return new ex(this.#B.withoutPlugins())}withSchema(e){return new ex(this.#B.withPluginAtFront(new ed.WithSchemaPlugin(e)))}}var eb=e.i(70445);class eO{ref(e){return new eb.DynamicReferenceBuilder(e)}}class eW{#D;constructor(e){this.#D=e}async provideConnection(e){let t=await this.#D.acquireConnection();try{return await e(t)}finally{await this.#D.releaseConnection(t)}}}var eC=e.i(78800),eq=e.i(52564);class ez extends eq.QueryExecutorBase{#L;#Q;#P;constructor(e,t,r,i=[]){super(i),this.#L=e,this.#Q=t,this.#P=r}get adapter(){return this.#Q}compileQuery(e){return this.#L.compileQuery(e)}provideConnection(e){return this.#P.provideConnection(e)}withPlugins(e){return new ez(this.#L,this.#Q,this.#P,[...this.plugins,...e])}withPlugin(e){return new ez(this.#L,this.#Q,this.#P,[...this.plugins,e])}withPluginAtFront(e){return new ez(this.#L,this.#Q,this.#P,[e,...this.plugins])}withConnectionProvider(e){return new ez(this.#L,this.#Q,e,[...this.plugins])}withoutPlugins(){return new ez(this.#L,this.#Q,this.#P,[])}}function ek(){return"undefined"!=typeof performance&&(0,t.isFunction)(performance.now)?performance.now():Date.now()}class eI{#D;#R;#M;#F;#U;#V=new WeakSet;constructor(e,t){this.#F=!1,this.#D=e,this.#R=t}async init(){if(this.#U)throw Error("driver has already been destroyed");this.#M||(this.#M=this.#D.init().then(()=>{this.#F=!0}).catch(e=>(this.#M=void 0,Promise.reject(e)))),await this.#M}async acquireConnection(){if(this.#U)throw Error("driver has already been destroyed");this.#F||await this.init();let e=await this.#D.acquireConnection();return this.#V.has(e)||(this.#J()&&this.#$(e),this.#V.add(e)),e}async releaseConnection(e){await this.#D.releaseConnection(e)}beginTransaction(e,t){return this.#D.beginTransaction(e,t)}commitTransaction(e){return this.#D.commitTransaction(e)}rollbackTransaction(e){return this.#D.rollbackTransaction(e)}async destroy(){this.#M&&(await this.#M,this.#U||(this.#U=this.#D.destroy().catch(e=>(this.#U=void 0,Promise.reject(e)))),await this.#U)}#J(){return this.#R.isLevelEnabled("query")||this.#R.isLevelEnabled("error")}#$(e){let t=e.executeQuery;e.executeQuery=async r=>{let i,n=ek();try{return await t.call(e,r)}catch(e){throw i=e,await this.#j(e,r,n),e}finally{i||await this.#_(r,n)}}}async #j(e,t,r){await this.#R.error(()=>({level:"error",error:e,query:t,queryDurationMillis:this.#K(r)}))}async #_(e,t){await this.#R.query(()=>({level:"query",query:e,queryDurationMillis:this.#K(t)}))}#K(e){return ek()-e}}let eT=()=>{};class eS{#G;#H;constructor(e){this.#G=e}async provideConnection(e){for(;this.#H;)await this.#H.catch(eT);return this.#H=this.#X(e).finally(()=>{this.#H=void 0}),this.#H}async #X(e){return await e(this.#G)}}let eA=["read uncommitted","read committed","repeatable read","serializable","snapshot"];var eE=e.i(25176);(0,t.freeze)(["query","error"]);class eB{#Y;#Z;constructor(e){(0,t.isFunction)(e)?(this.#Z=e,this.#Y=(0,t.freeze)({query:!0,error:!0})):(this.#Z=eD,this.#Y=(0,t.freeze)({query:e.includes("query"),error:e.includes("error")}))}isLevelEnabled(e){return this.#Y[e]}async query(e){this.#Y.query&&await this.#Z(e())}async error(e){this.#Y.error&&await this.#Z(e())}}function eD(e){"query"===e.level?(console.log(`kysely:query: ${e.query.sql}`),console.log(`kysely:query: duration: ${e.queryDurationMillis.toFixed(1)}ms`)):"error"===e.level&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:e.error,query:e.query.sql,queryDurationMillis:e.queryDurationMillis})}`))}var eL=e.i(91658),eQ=e.i(2757);class eP extends eC.QueryCreator{#o;constructor(e){let r,i;if(function(e){return(0,t.isObject)(e)&&(0,t.isObject)(e.config)&&(0,t.isObject)(e.driver)&&(0,t.isObject)(e.executor)&&(0,t.isObject)(e.dialect)}(e))r={executor:e.executor},i={...e};else{const t=e.dialect,n=t.createDriver(),o=t.createQueryCompiler(),s=t.createAdapter(),a=new eI(n,new eB(e.log??[])),d=new ez(o,s,new eW(a),e.plugins??[]);r={executor:d},i={config:e,executor:d,dialect:t,driver:a}}super(r),this.#o=(0,t.freeze)(i)}get schema(){return new ex(this.#o.executor)}get dynamic(){return new eO}get introspection(){return this.#o.dialect.createIntrospector(this.withoutPlugins())}case(e){return new eL.CaseBuilder({node:eQ.CaseNode.create((0,t.isUndefined)(e)?void 0:(0,er.parseExpression)(e))})}get fn(){return(0,eE.createFunctionModule)()}transaction(){return new eF({...this.#o})}connection(){return new eM({...this.#o})}withPlugin(e){return new eP({...this.#o,executor:this.#o.executor.withPlugin(e)})}withoutPlugins(){return new eP({...this.#o,executor:this.#o.executor.withoutPlugins()})}withSchema(e){return new eP({...this.#o,executor:this.#o.executor.withPluginAtFront(new ed.WithSchemaPlugin(e))})}withTables(){return new eP({...this.#o})}async destroy(){await this.#o.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#o.executor}executeQuery(e,r=(0,ea.createQueryId)()){let i=(0,t.isObject)(e)&&(0,t.isFunction)(e.compile)?e.compile():e;return this.getExecutor().executeQuery(i,r)}}class eR extends eP{#o;constructor(e){super(e),this.#o=e}get isTransaction(){return!0}transaction(){throw Error("calling the transaction method for a Transaction is not supported")}connection(){throw Error("calling the connection method for a Transaction is not supported")}async destroy(){throw Error("calling the destroy method for a Transaction is not supported")}withPlugin(e){return new eR({...this.#o,executor:this.#o.executor.withPlugin(e)})}withoutPlugins(){return new eR({...this.#o,executor:this.#o.executor.withoutPlugins()})}withSchema(e){return new eR({...this.#o,executor:this.#o.executor.withPluginAtFront(new ed.WithSchemaPlugin(e))})}withTables(){return new eR({...this.#o})}}class eM{#o;constructor(e){this.#o=(0,t.freeze)(e)}async execute(e){return this.#o.executor.provideConnection(async t=>{let r=this.#o.executor.withConnectionProvider(new eS(t)),i=new eP({...this.#o,executor:r});return await e(i)})}}(0,y.preventAwait)(eM,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");class eF{#o;constructor(e){this.#o=(0,t.freeze)(e)}setIsolationLevel(e){return new eF({...this.#o,isolationLevel:e})}async execute(e){let{isolationLevel:t,...r}=this.#o,i={isolationLevel:t};return function(e){if(e.isolationLevel&&!eA.includes(e.isolationLevel))throw Error(`invalid transaction isolation level ${e.isolationLevel}`)}(i),this.#o.executor.provideConnection(async t=>{let n=this.#o.executor.withConnectionProvider(new eS(t)),o=new eR({...r,executor:n});try{await this.#o.driver.beginTransaction(t,i);let r=await e(o);return await this.#o.driver.commitTransaction(t),r}catch(e){throw await this.#o.driver.rollbackTransaction(t),e}})}}(0,y.preventAwait)(eF,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method"),e.s(["Kysely",()=>eP],87679)},73440,e=>{"use strict";var t=e.i(1765),r=e.i(59094);let i=(0,r.freeze)({raw:(e,i=[])=>(0,r.freeze)({sql:e,query:t.RawNode.createWithSql(e),parameters:(0,r.freeze)(i)})}),n=Symbol();class o{#ee;#V=new WeakMap;#et;constructor(e){this.#ee=(0,r.freeze)({...e})}async init(){this.#et=(0,r.isFunction)(this.#ee.pool)?await this.#ee.pool():this.#ee.pool}async acquireConnection(){let e=await this.#et.connect(),t=this.#V.get(e);return!t&&(t=new s(e,{cursor:this.#ee.cursor??null}),this.#V.set(e,t),this.#ee.onCreateConnection&&await this.#ee.onCreateConnection(t)),this.#ee.onReserveConnection&&await this.#ee.onReserveConnection(t),t}async beginTransaction(e,t){t.isolationLevel?await e.executeQuery(i.raw(`start transaction isolation level ${t.isolationLevel}`)):await e.executeQuery(i.raw("begin"))}async commitTransaction(e){await e.executeQuery(i.raw("commit"))}async rollbackTransaction(e){await e.executeQuery(i.raw("rollback"))}async releaseConnection(e){e[n]()}async destroy(){if(this.#et){let e=this.#et;this.#et=void 0,await e.end()}}}class s{#er;#ei;constructor(e,t){this.#er=e,this.#ei=t}async executeQuery(e){try{let t=await this.#er.query(e.sql,[...e.parameters]);if("INSERT"===t.command||"UPDATE"===t.command||"DELETE"===t.command||"MERGE"===t.command){let e=BigInt(t.rowCount);return{numUpdatedOrDeletedRows:e,numAffectedRows:e,rows:t.rows??[]}}return{rows:t.rows??[]}}catch(e){throw function(e,t){var i;if(i=e,(0,r.isObject)(i)&&(0,r.isString)(i.stack)&&t.stack){let r=t.stack.split("\n").slice(1).join("\n");e.stack+=`
${r}`}return e}(e,Error())}}async *streamQuery(e,t){if(!this.#ei.cursor)throw Error("'cursor' is not present in your postgres dialect config. It's required to make streaming work in postgres.");if(!Number.isInteger(t)||t<=0)throw Error("chunkSize must be a positive integer");let r=this.#er.query(new this.#ei.cursor(e.sql,e.parameters.slice()));try{for(;;){let e=await r.read(t);if(0===e.length)break;yield{rows:e}}}finally{await r.close()}}[n](){this.#er.release()}}e.i(99948),(0,r.freeze)({__noMigrations__:!0});var a=e.i(61761),d=e.i(44473),p=e.i(4196),h=e.i(58390),u=e.i(92465),c=e.i(29961),l=e.i(26951),f=e.i(50495),m=e.i(48490),N=e.i(42856);class y{#o;constructor(e){this.#o=(0,r.freeze)(e)}get expressionType(){}get isRawBuilder(){return!0}as(e){return new g(this,e)}$castTo(){return new y({...this.#o})}$notNull(){return new y(this.#o)}withPlugin(e){return new y({...this.#o,plugins:void 0!==this.#o.plugins?(0,r.freeze)([...this.#o.plugins,e]):(0,r.freeze)([e])})}toOperationNode(){return this.#en(this.#eo())}compile(e){return this.#es(this.#eo(e))}async execute(e){let t=this.#eo(e);return t.executeQuery(this.#es(t),this.#o.queryId)}#eo(e){let t=void 0!==e?e.getExecutor():N.NOOP_QUERY_EXECUTOR;return void 0!==this.#o.plugins?t.withPlugins(this.#o.plugins):t}#en(e){return e.transformQuery(this.#o.rawNode,this.#o.queryId)}#es(e){return e.compileQuery(this.#en(e),this.#o.queryId)}}function w(e){return new y(e)}(0,m.preventAwait)(y,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");class g{#ea;#z;constructor(e,t){this.#ea=e,this.#z=t}get expression(){return this.#ea}get alias(){return this.#z}get rawBuilder(){return this.#ea}toOperationNode(){return f.AliasNode.create(this.#ea.toOperationNode(),(0,d.isOperationNodeSource)(this.#z)?this.#z.toOperationNode():a.IdentifierNode.create(this.#z))}}(0,m.preventAwait)(g,"don't await AliasedRawBuilder instances directly. AliasedRawBuilder should never be executed directly since it's always a part of another query.");let v=Object.assign((e,...r)=>w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.create(e,r?.map(x)??[])}),{ref:e=>w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.createWithChild((0,h.parseStringReference)(e))}),val:e=>w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.createWithChild((0,c.parseValueExpression)(e))}),value(e){return this.val(e)},table:e=>w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.createWithChild((0,u.parseTable)(e))}),id(...e){let r=Array(e.length+1).fill(".");return r[0]="",r[r.length-1]="",w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.create(r,e.map(a.IdentifierNode.create))})},lit:e=>w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.createWithChild(p.ValueNode.createImmediate(e))}),literal(e){return this.lit(e)},raw:e=>w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.createWithSql(e)}),join(e,r=v`, `){let i=Array(2*e.length-1),n=r.toOperationNode();for(let t=0;t<e.length;++t)i[2*t]=x(e[t]),t!==e.length-1&&(i[2*t+1]=n);return w({queryId:(0,l.createQueryId)(),rawNode:t.RawNode.createWithChildren(i)})}});function x(e){return(0,d.isOperationNodeSource)(e)?e.toOperationNode():(0,c.parseValueExpression)(e)}class b{#ed;constructor(e){this.#ed=e}async getSchemas(){return(await this.#ed.selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map(e=>({name:e.nspname}))}async getTables(e={withInternalKyselyTables:!1}){let t=this.#ed.selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",v`col_description(a.attrelid, a.attnum)`.as("column_description"),this.#ed.selectFrom("pg_class").select(v`true`.as("auto_incrementing")).whereRef("relnamespace","=","c.relnamespace").where("relkind","=","S").where("relname","=",v`c.relname || '_' || a.attname || '_seq'`).as("auto_incrementing")]).where(e=>e.or([e("c.relkind","=","r"),e("c.relkind","=","v"),e("c.relkind","=","p")])).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();e.withInternalKyselyTables||(t=t.where("c.relname","!=","kysely_migration").where("c.relname","!=","kysely_migration_lock"));let r=await t.execute();return this.#ep(r)}async getMetadata(e){return{tables:await this.getTables(e)}}#ep(e){return e.reduce((e,t)=>{let i=e.find(e=>e.name===t.table&&e.schema===t.schema);return i||(i=(0,r.freeze)({name:t.table,isView:"v"===t.table_type,schema:t.schema,columns:[]}),e.push(i)),i.columns.push((0,r.freeze)({name:t.column,dataType:t.type,dataTypeSchema:t.type_schema,isNullable:!t.not_null,isAutoIncrementing:!!t.auto_incrementing,hasDefaultValue:t.has_default,comment:t.column_description??void 0})),e},[])}}var O=e.i(69972),W=e.i(80182);class C{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#eh=(0,r.freeze)({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#eh[e.kind](e),this.nodeStack.pop()}}var q=e.i(80727),z=e.i(88986),k=e.i(92868),I=e.i(78655),T=e.i(39504),S=e.i(91494);class A extends C{#eu="";#ec=[];get numParameters(){return this.#ec.length}compileQuery(e){return this.#eu="",this.#ec=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(e),(0,r.freeze)({query:e,sql:this.getSql(),parameters:[...this.#ec]})}getSql(){return this.#eu}visitSelectQuery(e){let t=void 0!==this.parentNode&&!z.ParensNode.is(this.parentNode)&&!W.InsertQueryNode.is(this.parentNode)&&!O.CreateTableNode.is(this.parentNode)&&!I.CreateViewNode.is(this.parentNode)&&!T.SetOperationNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.top&&(this.append(" "),this.visitNode(e.top)),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.fetch&&(this.append(" "),this.visitNode(e.fetch)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),t&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){let r=e.length-1;for(let i=0;i<=r;i++)this.visitNode(e[i]),i<r&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){let t=this.nodeStack.find(k.QueryNode.is),r=t!==e;!r&&e.explain&&(this.visitNode(e.explain),this.append(" ")),r&&!S.MergeQueryNode.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&this.append(" ignore"),e.top&&(this.append(" "),this.visitNode(e.top)),e.into&&(this.append(" into "),this.visitNode(e.into)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.output&&(this.append(" "),this.visitNode(e.output)),e.values&&(this.append(" "),this.visitNode(e.values)),e.defaultValues&&(this.append(" "),this.append("default values")),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),r&&!S.MergeQueryNode.is(t)&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){let t=this.nodeStack.find(k.QueryNode.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),e.top&&(this.visitNode(e.top),this.append(" ")),this.visitNode(e.from),e.output&&(this.append(" "),this.visitNode(e.output)),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!(0,r.isString)(e.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");let{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(D[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){let{sqlFragments:t,parameters:r}=e;for(let e=0;e<t.length;++e)this.append(t[e]),r.length>e&&this.visitNode(r[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),e.selectQuery?(this.append(" as "),this.visitNode(e.selectQuery)):(this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," ")))}visitColumnDefinition(e){e.ifNotExists&&this.append("if not exists "),this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.identity&&this.append(" identity"),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.direction&&(this.append(" "),this.visitNode(e.direction))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){let t=this.nodeStack.find(k.QueryNode.is),r=t!==e;!r&&e.explain&&(this.visitNode(e.explain),this.append(" ")),r&&!S.MergeQueryNode.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),e.top&&(this.visitNode(e.top),this.append(" ")),e.table&&(this.visitNode(e.table),this.append(" ")),this.append("set "),e.updates&&this.compileList(e.updates),e.output&&(this.append(" "),this.visitNode(e.output)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),r&&!S.MergeQueryNode.is(t)&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")")}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(e.columns),this.append(")")}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),(0,r.isBoolean)(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.columnAlterations&&this.compileColumnAlterations(e.columnAlterations),e.addIndex&&this.visitNode(e.addIndex),e.dropIndex&&this.visitNode(e.dropIndex)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(E[e.modifier]),e.of&&(this.append(" of "),this.compileList(e.of,", "))}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),this.append(")"),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return q.OperatorNode.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){for(let t of(e.inOperator&&this.visitNode(e.inOperator),this.append("'$"),e.pathLegs))this.visitNode(t);this.append("'")}visitJSONPathLeg(e){let t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,r=e.values.length;t<r;t++)t===r-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}visitMergeQuery(e){e.with&&(this.visitNode(e.with),this.append(" ")),this.append("merge "),e.top&&(this.visitNode(e.top),this.append(" ")),this.append("into "),this.visitNode(e.into),e.using&&(this.append(" "),this.visitNode(e.using)),e.whens&&(this.append(" "),this.compileList(e.whens," ")),e.output&&(this.append(" "),this.visitNode(e.output)),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitMatched(e){e.not&&this.append("not "),this.append("matched"),e.bySource&&this.append(" by source")}visitAddIndex(e){this.append("add "),e.unique&&this.append("unique "),this.append("index "),this.visitNode(e.name),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.using&&(this.append(" using "),this.visitNode(e.using))}visitCast(e){this.append("cast("),this.visitNode(e.expression),this.append(" as "),this.visitNode(e.dataType),this.append(")")}visitFetch(e){this.append("fetch next "),this.visitNode(e.rowCount),this.append(` rows ${e.modifier}`)}visitOutput(e){this.append("output "),this.compileList(e.selections)}visitTop(e){this.append(`top(${e.expression})`),e.modifiers&&this.append(` ${e.modifiers}`)}append(e){this.#eu+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){let t=this.getLeftIdentifierWrapper(),r=this.getRightIdentifierWrapper(),i="";for(let n of e)i+=n,n===t?i+=t:n===r&&(i+=r);return i}addParameter(e){this.#ec.push(e)}appendImmediateValue(e){if((0,r.isString)(e))this.append(`'${e}'`);else if((0,r.isNumber)(e)||(0,r.isBoolean)(e))this.append(e.toString());else if((0,r.isNull)(e))this.append("null");else if((0,r.isDate)(e))this.appendImmediateValue(e.toISOString());else if((0,r.isBigInt)(e))this.appendImmediateValue(e.toString());else throw Error(`invalid immediate value ${e}`)}sortSelectModifiers(e){return e.sort((e,t)=>e.modifier&&t.modifier?B[e.modifier]-B[t.modifier]:1),(0,r.freeze)(e)}compileColumnAlterations(e){this.compileList(e)}announcesNewColumnDataType(){return!0}}let E=(0,r.freeze)({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),B=(0,r.freeze)({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),D=(0,r.freeze)({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",Using:"using"}),L=/"/g;class Q extends A{sanitizeIdentifier(e){return e.replace(L,'""')}}class P{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}get supportsOutput(){return!1}}let R=BigInt("3853314791062309107");class M extends P{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock(e,t){await v`select pg_advisory_xact_lock(${v.lit(R)})`.execute(e)}async releaseMigrationLock(e,t){}}class F{#ee;constructor(e){this.#ee=e}createDriver(){return new o(this.#ee)}createQueryCompiler(){return new Q}createAdapter(){return new M}createIntrospector(e){return new b(e)}}e.s(["PostgresDialect",()=>F],73440)},30056,e=>e.a(async(t,r)=>{try{let t=await e.y("pg");e.n(t),r()}catch(e){r(e)}},!0),3985,e=>e.a(async(t,r)=>{try{var i=e.i(13286),n=e.i(87679),o=e.i(73440),s=e.i(30056),a=t([s]);[s]=a.then?(await a)():a;let d=new s.Pool({connectionString:process.env.DATABASE_URL,max:10}),p=new n.Kysely({dialect:new o.PostgresDialect({pool:d}),plugins:[new i.CamelCasePlugin]});e.s(["db",0,p]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__77c5a4c4._.js.map