module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},89139,36843,e=>{"use strict";var t=e.i(63206);e.s([],89139),e.s(["logger",()=>t.i],36843)},35722,e=>e.a(async(t,r)=>{try{var a=e.i(53707),n=t([a]);async function o(e){return a.auth.api.getSession({headers:e.headers})}[a]=n.then?(await n)():n,e.s(["getSession",()=>o]),r()}catch(e){r(e)}},!1),22632,e=>{"use strict";e.s([],54033),e.i(54033);var t=e.i(85676),r=e.i(80264);e.s(["defaultErrorMap",()=>r.default,"getErrorMap",()=>t.getErrorMap,"setErrorMap",()=>t.setErrorMap],76733),e.i(76733);var a=e.i(84488);e.s([],91316),e.i(91316);var n=e.i(42944),o=e.i(17958),s=e.i(15235);e.s(["BRAND",()=>o.BRAND,"DIRTY",()=>a.DIRTY,"EMPTY_PATH",()=>a.EMPTY_PATH,"INVALID",()=>a.INVALID,"NEVER",()=>o.NEVER,"OK",()=>a.OK,"ParseStatus",()=>a.ParseStatus,"Schema",()=>o.Schema,"ZodAny",()=>o.ZodAny,"ZodArray",()=>o.ZodArray,"ZodBigInt",()=>o.ZodBigInt,"ZodBoolean",()=>o.ZodBoolean,"ZodBranded",()=>o.ZodBranded,"ZodCatch",()=>o.ZodCatch,"ZodDate",()=>o.ZodDate,"ZodDefault",()=>o.ZodDefault,"ZodDiscriminatedUnion",()=>o.ZodDiscriminatedUnion,"ZodEffects",()=>o.ZodEffects,"ZodEnum",()=>o.ZodEnum,"ZodError",()=>s.ZodError,"ZodFirstPartyTypeKind",()=>o.ZodFirstPartyTypeKind,"ZodFunction",()=>o.ZodFunction,"ZodIntersection",()=>o.ZodIntersection,"ZodIssueCode",()=>s.ZodIssueCode,"ZodLazy",()=>o.ZodLazy,"ZodLiteral",()=>o.ZodLiteral,"ZodMap",()=>o.ZodMap,"ZodNaN",()=>o.ZodNaN,"ZodNativeEnum",()=>o.ZodNativeEnum,"ZodNever",()=>o.ZodNever,"ZodNull",()=>o.ZodNull,"ZodNullable",()=>o.ZodNullable,"ZodNumber",()=>o.ZodNumber,"ZodObject",()=>o.ZodObject,"ZodOptional",()=>o.ZodOptional,"ZodParsedType",()=>n.ZodParsedType,"ZodPipeline",()=>o.ZodPipeline,"ZodPromise",()=>o.ZodPromise,"ZodReadonly",()=>o.ZodReadonly,"ZodRecord",()=>o.ZodRecord,"ZodSchema",()=>o.ZodSchema,"ZodSet",()=>o.ZodSet,"ZodString",()=>o.ZodString,"ZodSymbol",()=>o.ZodSymbol,"ZodTransformer",()=>o.ZodTransformer,"ZodTuple",()=>o.ZodTuple,"ZodType",()=>o.ZodType,"ZodUndefined",()=>o.ZodUndefined,"ZodUnion",()=>o.ZodUnion,"ZodUnknown",()=>o.ZodUnknown,"ZodVoid",()=>o.ZodVoid,"addIssueToContext",()=>a.addIssueToContext,"any",()=>o.any,"array",()=>o.array,"bigint",()=>o.bigint,"boolean",()=>o.boolean,"coerce",()=>o.coerce,"custom",()=>o.custom,"date",()=>o.date,"datetimeRegex",()=>o.datetimeRegex,"defaultErrorMap",()=>r.default,"discriminatedUnion",()=>o.discriminatedUnion,"effect",()=>o.effect,"enum",()=>o.enum,"function",()=>o.function,"getErrorMap",()=>t.getErrorMap,"getParsedType",()=>n.getParsedType,"instanceof",()=>o.instanceof,"intersection",()=>o.intersection,"isAborted",()=>a.isAborted,"isAsync",()=>a.isAsync,"isDirty",()=>a.isDirty,"isValid",()=>a.isValid,"late",()=>o.late,"lazy",()=>o.lazy,"literal",()=>o.literal,"makeIssue",()=>a.makeIssue,"map",()=>o.map,"nan",()=>o.nan,"nativeEnum",()=>o.nativeEnum,"never",()=>o.never,"null",()=>o.null,"nullable",()=>o.nullable,"number",()=>o.number,"object",()=>o.object,"objectUtil",()=>n.objectUtil,"oboolean",()=>o.oboolean,"onumber",()=>o.onumber,"optional",()=>o.optional,"ostring",()=>o.ostring,"pipeline",()=>o.pipeline,"preprocess",()=>o.preprocess,"promise",()=>o.promise,"quotelessJson",()=>s.quotelessJson,"record",()=>o.record,"set",()=>o.set,"setErrorMap",()=>t.setErrorMap,"strictObject",()=>o.strictObject,"string",()=>o.string,"symbol",()=>o.symbol,"transformer",()=>o.transformer,"tuple",()=>o.tuple,"undefined",()=>o.undefined,"union",()=>o.union,"unknown",()=>o.unknown,"util",()=>n.util,"void",()=>o.void],35907);var i=e.i(35907);e.s(["z",0,i],22632)},32828,e=>{"use strict";var t=e.i(66680),r=e.i(27356);let a="doccov_";function n(){let e=(0,r.nanoid)(32),t=`${a}${e}`,n=o(t),s=t.slice(0,12);return{key:t,hash:n,prefix:s}}function o(e){return(0,t.createHash)("sha256").update(e).digest("hex")}function s(e){return e.startsWith(a)&&e.length===a.length+32}e.s(["generateApiKey",()=>n,"hashApiKey",()=>o,"isValidKeyFormat",()=>s])},30682,e=>{"use strict";var t=e.i(32828);async function r(e,r){let a=e.headers.get("Authorization");if(!a)return{ok:!1,error:"API key required",status:401,docs:"https://docs.doccov.com/api-keys"};if(!a.startsWith("Bearer "))return{ok:!1,error:"Invalid Authorization header. Use: Bearer <api_key>",status:401};let n=a.slice(7);if(!(0,t.isValidKeyFormat)(n))return{ok:!1,error:"Invalid API key format",status:401};let o=(0,t.hashApiKey)(n),s=await r.selectFrom("api_keys").innerJoin("organizations","organizations.id","api_keys.orgId").where("api_keys.keyHash","=",o).where(e=>e.or([e("api_keys.expiresAt","is",null),e("api_keys.expiresAt",">",new Date)])).select(["api_keys.id as keyId","api_keys.orgId","api_keys.name as keyName","organizations.plan","organizations.aiCallsUsed","organizations.aiCallsResetAt"]).executeTakeFirst();return s?"free"===s.plan?{ok:!1,error:"API access requires a paid plan",status:403,upgrade:"https://doccov.com/pricing"}:(r.updateTable("api_keys").set({lastUsedAt:new Date}).where("id","=",s.keyId).execute().catch(console.error),{ok:!0,context:{apiKey:{id:s.keyId,orgId:s.orgId,name:s.keyName},org:{id:s.orgId,plan:s.plan,aiCallsUsed:s.aiCallsUsed,aiCallsResetAt:s.aiCallsResetAt}}}):{ok:!1,error:"Invalid or expired API key",status:401}}e.s(["validateApiKey",()=>r])},26575,e=>{"use strict";var t=e.i(22632);t.z.object({DATABASE_URL:t.z.string().url(),GITHUB_CLIENT_ID:t.z.string().min(1),GITHUB_CLIENT_SECRET:t.z.string().min(1),GITHUB_APP_ID:t.z.string().min(1).optional(),GITHUB_APP_PRIVATE_KEY:t.z.string().min(1).optional(),GITHUB_APP_WEBHOOK_SECRET:t.z.string().min(1).optional(),POLAR_ACCESS_TOKEN:t.z.string().min(1).optional(),POLAR_WEBHOOK_SECRET:t.z.string().min(1).optional(),POLAR_PRODUCT_TEAM:t.z.string().optional(),POLAR_PRODUCT_PRO:t.z.string().optional(),ANTHROPIC_API_KEY:t.z.string().min(1).optional(),OPENAI_API_KEY:t.z.string().min(1).optional(),SITE_URL:t.z.string().url().default("http://localhost:3000"),API_URL:t.z.string().url().default("http://localhost:3001"),SANDBOX_URL:t.z.string().url().optional(),SANDBOX_SECRET:t.z.string().min(1).optional(),NODE_ENV:t.z.enum(["development","production","test"]).default("development")}),e.i(30682);class r{store=new Map;get(e){let t=this.store.get(e);return t&&Date.now()>t.resetAt?void this.store.delete(e):t}increment(e,t){let r=Date.now(),a=this.get(e);if(a)return a.count++,a;let n={count:1,resetAt:r+t};return this.store.set(e,n),n}cleanup(){let e=Date.now();for(let[t,r]of this.store.entries())e>r.resetAt&&this.store.delete(t)}}let a=new r;"undefined"!=typeof setInterval&&setInterval(()=>a.cleanup(),6e4).unref?.(),e.i(32828),e.s([],26575)},22939,e=>e.a(async(t,r)=>{try{e.i(26575);var a=e.i(32828),n=e.i(27356),o=e.i(3985),s=e.i(35722),i=t([o,s]);async function d(e){let t=new URL(e.url).searchParams.get("orgId");if(!t)return Response.json({error:"orgId required"},{status:400});let r=await (0,s.getSession)(e);if(!r)return Response.json({error:"Unauthorized"},{status:401});if(!await o.db.selectFrom("org_members").where("orgId","=",t).where("userId","=",r.user.id).select("role").executeTakeFirst())return Response.json({error:"Not a member"},{status:403});let a=await o.db.selectFrom("api_keys").where("orgId","=",t).select(["id","name","keyPrefix","lastUsedAt","expiresAt","createdAt"]).orderBy("createdAt","desc").execute();return Response.json({keys:a})}async function l(e){let t=await (0,s.getSession)(e);if(!t)return Response.json({error:"Unauthorized"},{status:401});let{orgId:r,name:i,expiresIn:d}=await e.json();if(!r||!i)return Response.json({error:"orgId and name required"},{status:400});let l=await o.db.selectFrom("org_members").innerJoin("organizations","organizations.id","org_members.orgId").where("org_members.orgId","=",r).where("org_members.userId","=",t.user.id).where("org_members.role","in",["owner","admin"]).select(["org_members.role","organizations.plan"]).executeTakeFirst();if(!l)return Response.json({error:"Admin access required"},{status:403});if("free"===l.plan)return Response.json({error:"API keys require a paid plan",upgrade:"https://doccov.com/pricing"},{status:403});let{key:u,hash:p,prefix:c}=(0,a.generateApiKey)(),m=(0,n.nanoid)(21),h=d?new Date(Date.now()+24*d*36e5):null;return await o.db.insertInto("api_keys").values({id:m,orgId:r,name:i,keyHash:p,keyPrefix:c,expiresAt:h}).execute(),Response.json({id:m,key:u,name:i,prefix:c,expiresAt:h,message:"Save this key now. It cannot be retrieved again."},{status:201})}[o,s]=i.then?(await i)():i,e.s(["GET",()=>d,"POST",()=>l]),r()}catch(e){r(e)}},!1),11963,e=>e.a(async(t,r)=>{try{var a=e.i(47909),n=e.i(74017),o=e.i(96250),s=e.i(59756),i=e.i(61916),d=e.i(14444),l=e.i(37092),u=e.i(69741),p=e.i(16795),c=e.i(87718),m=e.i(95169),h=e.i(47587),g=e.i(66012),y=e.i(70101),_=e.i(26937),f=e.i(10372),R=e.i(93695);e.i(52474);var v=e.i(220),E=e.i(22939),A=t([E]);[E]=A.then?(await A)():A;let w=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/api-keys/route",pathname:"/api/api-keys",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/api-keys/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:I,workUnitAsyncStorage:x,serverHooks:k}=w;function Z(){return(0,o.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:x})}async function b(e,t,r){w.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/api-keys/route";a=a.replace(/\/index$/,"")||"/";let o=await w.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:E,params:A,nextConfig:Z,parsedUrl:b,isDraftMode:I,prerenderManifest:x,routerServerContext:k,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,resolvedPathname:C,clientReferenceManifest:N,serverActionsManifest:S}=o,U=(0,u.normalizeAppPath)(a),O=!!(x.dynamicRoutes[U]||x.routes[C]),j=async()=>((null==k?void 0:k.render404)?await k.render404(e,t,b,!1):t.end("This page could not be found"),null);if(O&&!I){let e=!!x.routes[C],t=x.dynamicRoutes[U];if(t&&!1===t.fallback&&!e){if(Z.experimental.adapterPath)return await j();throw new R.NoFallbackError}}let D=null;!O||w.isDev||I||(D=C,D="/index"===D?"/":D);let z=!0===w.isDev||!O,M=O&&!z;S&&N&&(0,d.setReferenceManifestsSingleton)({page:a,clientReferenceManifest:N,serverActionsManifest:S,serverModuleMap:(0,l.createServerModuleMap)({serverActionsManifest:S})});let H=e.method||"GET",q=(0,i.getTracer)(),B=q.getActiveScopeSpan(),K={params:A,prerenderManifest:x,renderOpts:{experimental:{authInterrupts:!!Z.experimental.authInterrupts},cacheComponents:!!Z.cacheComponents,supportsDynamicResponse:z,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:Z.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>w.onRequestError(e,t,a,k)},sharedContext:{buildId:E}},L=new p.NodeNextRequest(e),F=new p.NodeNextResponse(t),V=c.NextRequestAdapter.fromNodeNextRequest(L,(0,c.signalFromNodeResponse)(t));try{let o=async e=>w.handle(V,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=q.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${H} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${a}`)}),d=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var i,l;let u=async({previousCacheEntry:n})=>{try{if(!d&&P&&T&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await o(s);e.fetchMetrics=K.renderOpts.fetchMetrics;let i=K.renderOpts.pendingWaitUntil;i&&r.waitUntil&&(r.waitUntil(i),i=void 0);let l=K.renderOpts.collectedTags;if(!O)return await (0,g.sendResponse)(L,F,a,K.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,y.toNodeOutgoingHttpHeaders)(a.headers);l&&(t[f.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,n=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==n?void 0:n.isStale)&&await w.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:P})},k),t}},p=await w.handleResponse({req:e,nextConfig:Z,cacheKey:D,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:x,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:d});if(!O)return null;if((null==p||null==(i=p.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});d||t.setHeader("x-nextjs-cache",P?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),I&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,y.fromNodeOutgoingHttpHeaders)(p.value.headers);return d&&O||c.delete(f.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,_.getCacheControlHeader)(p.cacheControl)),await (0,g.sendResponse)(L,F,new Response(p.value.body,{headers:c,status:p.value.status||200})),null};B?await l(B):await q.withPropagatedContext(e.headers,()=>q.trace(m.BaseServerSpan.handleRequest,{spanName:`${H} ${a}`,kind:i.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await w.onRequestError(e,t,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:P})}),O)throw t;return await (0,g.sendResponse)(L,F,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>Z,"routeModule",()=>w,"serverHooks",()=>k,"workAsyncStorage",()=>I,"workUnitAsyncStorage",()=>x]),r()}catch(e){r(e)}},!1),76372,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_better-auth_dist_adapters_memory-adapter_index_mjs_61d56fbe._.js"].map(t=>e.l(t))).then(()=>t(68840)))},46120,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_better-auth_dist_adapters_kysely-adapter_index_mjs_e4618ae6._.js"].map(t=>e.l(t))).then(()=>t(69580)))},96605,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_better-auth_dist_adapters_kysely-adapter_bun-sqlite-dialect_mjs_81919b3b._.js"].map(t=>e.l(t))).then(()=>t(58634)))},61487,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_better-auth_dist_adapters_kysely-adapter_node-sqlite-dialect_mjs_4d47c97e._.js"].map(t=>e.l(t))).then(()=>t(2770)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a1193821._.js.map